{"version":3,"sources":["D2App/stores/installedApp.store.js","D2App/theme.js","D2App/stores/appHub.store.js","D2App/actions.js","D2App/components/AppList.component.js","D2App/components/AppHub.component.js","D2App/components/SelfUpdateNoticeBox.component.js","D2App/components/App.component.js","D2App/locales/index.js","D2App/AppWrapper.js"],"names":["store","Store","create","getAppFromKey","appKey","apps","getState","i","length","key","theme","spacing","Spacing","fontFamily","palette","primary1Color","primary2Color","blue700","primary3Color","blue100","accent1Color","orange500","accent2Color","grey100","accent3Color","grey500","textColor","darkBlack","alternateTextColor","white","canvasColor","borderColor","grey400","disabledColor","fade","muiTheme","getMuiTheme","appTheme","style","sideBar","backgroundColor","backgroundColorItem","backgroundColorItemActive","textColorActive","borderStyle","forms","minWidth","maxWidth","createAppTheme","Object","assign","getAppFromVersionId","versionId","app","j","versions","id","version","debug","Debug","actions","installApp","Action","uninstallApp","refreshApps","appInstalled","loadAppHub","installAppVersion","showSnackbarMessage","subscribe","params","zipFile","progressCallback","Array","isArray","data","undefined","getD2","then","d2","system","uploadApp","reloadApps","installedAppHub","setState","i18n","t","name","substring","lastIndexOf","complete","catch","err","message","log","error","async","baseUrl","Api","getApi","fetchOptions","credentials","headers","response","fetch","json","replace","getDhisVersion","appHubStore","appHubState","installing","uid","api","Promise","resolve","reject","post","join","dataType","appHubState2","appTypeHeaders","dashboard_widget","tracker_dashboard_widget","resource","appTypeMissing","styles","wrapper","position","header","fontSize","fontWeight","color","AppTheme","rawTheme","padding","container","borderBottom","paddingBottom","marginBottom","fab","top","right","fabAnim","float","noApps","marginTop","borderTop","appName","clear","appLink","textDecoration","appActions","display","marginRight","appButtons","marginLeft","appIcon","borderRadius","card","AppList","React","Component","constructor","props","context","super","this","state","uploading","uploadAction","bind","upload","componentDidMount","form","reset","e","fileInput","click","target","files","uploadProgress","renderInstalledApps","label","appTypeFilter","toLocaleLowerCase","appList","installedApps","filter","appType","Card","List","map","uninstall","moreIcon","className","open","window","launchUrl","rightIconButton","iconButtonElement","onClick","avatar","icons","src","icon","secondaryText","isBundledApp","folderName","primaryText","leftAvatar","renderUploadButton","renderEmptyList","showUpload","ref","visibility","type","r","onChange","render","defaultProps","AppHub","UNSAFE_componentWillMount","appHub","renderApps","width","cardTitle","background","cardTitleSubtitle","overflowX","overflowY","whiteSpace","textOverflow","cardText","height","textAlign","button","flex","flexWrap","title","subtitle","developer","organisation","titleColor","subtitleStyle","description","install","primary","loadingMaskContainer","left","bottom","zIndex","cardTitleText","paddingTop","parseVersion","versionString","split","Number","getTargetVersion","current","targetVersion","forEach","candidate","currentVersion","candidateVersion","some","v","needsUpdate","SelfUpdateNoticeBox","appManagementApp","find","toPromise","setTimeout","location","reload","progress","margin","paddingRight","snackbar","menuLabel","App","lastUpdate","fn","getChildContext","subscriptions","Date","setSection","toLowerCase","componentWillUnmount","subscription","dispose","sidebar","clearSearchBox","section","appSearch","p","closeSnackbar","showSnackbar","search","text","indexOf","sort","a","b","localeCompare","appSearchText","renderUploadProgress","mode","value","renderInstallProgress","renderSection","toString","toUpperCase","transitionUnmount","unmountSection","renderSearchResults","appsByType","reduce","types","prototype","hasOwnProperty","call","push","keys","sections","currentSection","onChangeSection","showSearchField","onChangeSearchText","autoHideDuration","onRequestClose","childContextTypes","PropTypes","object","addResources","arTranslations","csTranslations","enTranslations","frTranslations","idTranslations","nbTranslations","ruTranslations","svTranslations","uzTranslations","uz_CyrlTranslations","uz_LatnTranslations","viTranslations","zhTranslations","zh_CNTranslations","AppWrapper","useD2","onInitialized"],"mappings":"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","file":"static/js/app.419e779a.chunk.js","sourcesContent":["import Store from 'd2-ui/lib/store/Store';\nconst store = Store.create();\n\nstore.getAppFromKey = appKey => {\n  const apps = store.getState();\n\n  for (let i = 0; i < apps.length; i++) {\n    if (apps[i].key === appKey) {\n      return apps[i];\n    }\n  }\n\n  return null;\n};\n\nexport default store;","import Spacing from 'material-ui/styles/spacing';\nimport getMuiTheme from 'material-ui/styles/getMuiTheme';\nimport { blue700, blue100, orange500, grey100, grey500, darkBlack, white, grey400 } from 'material-ui/styles/colors';\nimport { fade } from 'material-ui/utils/colorManipulator';\nconst theme = {\n  spacing: Spacing,\n  fontFamily: 'Roboto, sans-serif',\n  palette: {\n    primary1Color: '#276696',\n    primary2Color: blue700,\n    primary3Color: blue100,\n    accent1Color: orange500,\n    accent2Color: grey100,\n    accent3Color: grey500,\n    textColor: darkBlack,\n    alternateTextColor: white,\n    canvasColor: white,\n    borderColor: grey400,\n    disabledColor: fade(darkBlack, 0.3)\n  }\n};\n\nfunction createAppTheme(style) {\n  return {\n    sideBar: {\n      backgroundColor: '#F3F3F3',\n      backgroundColorItem: 'transparent',\n      backgroundColorItemActive: style.palette.accent2Color,\n      textColor: style.palette.textColor,\n      textColorActive: style.palette.primary1Color,\n      borderStyle: '1px solid #e1e1e1'\n    },\n    forms: {\n      minWidth: 350,\n      maxWidth: 900\n    }\n  };\n}\n\nconst muiTheme = getMuiTheme(theme);\nconst appTheme = createAppTheme(theme);\nexport default Object.assign({}, muiTheme, appTheme);","import Store from 'd2-ui/lib/store/Store';\nconst store = Store.create();\n\nfunction getAppFromVersionId(versionId) {\n  for (let i = 0; i < store.getState().apps.length; i++) {\n    const app = store.getState().apps[i];\n\n    for (let j = 0; j < app.versions.length; j++) {\n      if (app.versions[j].id === versionId) {\n        app.version = app.versions[j];\n        return app;\n      }\n    }\n  }\n\n  return null;\n}\n\nstore.getAppFromVersionId = getAppFromVersionId;\nexport default store;","import Debug from 'debug';\nimport Action from 'd2-ui/lib/action/Action';\nimport { getInstance as getD2 } from 'd2';\nimport log from 'loglevel';\nimport appHubStore from './stores/appHub.store';\nimport installedAppHub from './stores/installedApp.store';\nimport i18n from '@dhis2/d2-i18n';\nconst debug = Debug('app-management-app:frontend:client');\nconst actions = {\n  // App management actions\n  installApp: Action.create('Install App'),\n  uninstallApp: Action.create('Uninstall App'),\n  refreshApps: Action.create('Refresh Apps'),\n  appInstalled: Action.create('An app was installed'),\n  // App store actions\n  loadAppHub: Action.create('Load DHIS2 App Hub'),\n  installAppVersion: Action.create('Install App Version from DHIS2 App Hub'),\n  // Snackbar\n  showSnackbarMessage: Action.create('Show Snackbar message')\n};\n/*\n * Install app from zip file\n */\n\nactions.installApp.subscribe(params => {\n  const [zipFile, progressCallback] = Array.isArray(params.data) ? params.data : [params.data, undefined];\n  getD2().then(d2 => {\n    d2.system.uploadApp(zipFile, progressCallback).then(() => d2.system.reloadApps()).then(apps => {\n      installedAppHub.setState(apps);\n      actions.showSnackbarMessage(i18n.t('App installed successfully'));\n      actions.appInstalled(zipFile.name.substring(0, zipFile.name.lastIndexOf('.')));\n      actions.refreshApps();\n      params.complete();\n    }).catch(err => {\n      let message = i18n.t('Failed to install app');\n\n      if (err.message) {\n        message += `: ${err.message}`;\n      }\n\n      actions.showSnackbarMessage(message);\n      log.error('Failed to install app:', err.message || err);\n      actions.refreshApps();\n    });\n  });\n});\n/*\n * Uninstall app\n */\n\nactions.uninstallApp.subscribe(params => {\n  const appKey = params.data[0];\n  getD2().then(d2 => {\n    d2.system.uninstallApp(appKey).then(() => {\n      actions.showSnackbarMessage(i18n.t('App removed successfully'));\n      actions.refreshApps();\n    });\n  });\n});\n/*\n * Refresh the list of installed apps\n */\n\nactions.refreshApps.subscribe(() => {\n  getD2().then(d2 => {\n    d2.system.reloadApps().then(apps => {\n      installedAppHub.setState(apps);\n    });\n  });\n});\n/*\n * Load the app hub\n */\n\nactions.loadAppHub.subscribe(async () => {\n  const d2 = await getD2();\n  const baseUrl = d2.Api.getApi().baseUrl;\n  debug(`Got baseUrl: ${baseUrl}`);\n  const fetchOptions = {\n    credentials: 'include',\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  };\n\n  const getDhisVersion = async () => {\n    const response = await fetch(`${baseUrl}/system/info`, fetchOptions);\n    const json = await response.json(); //if we're running a dev version remove the snapshot suffix to just keep the dhis version\n\n    return json.version.replace('-SNAPSHOT', '');\n  };\n\n  const version = await getDhisVersion();\n  debug(`Got dhis2 version: ${version}`);\n  const response = await fetch(`${baseUrl}/appHub/v1/apps?dhis_version=${version}`, fetchOptions);\n  const apps = await response.json();\n  appHubStore.setState(Object.assign(appHubStore.getState() || {}, {\n    apps\n  }));\n});\n/*\n * Install app version from the app hub\n */\n\nactions.installAppVersion.subscribe(params => {\n  const versionId = params.data[0];\n  const appHubState = appHubStore.getState();\n  appHubStore.setState(Object.assign(appHubState, {\n    installing: appHubState.installing ? appHubState.installing + 1 : 1\n  }));\n  getD2().then(d2 => {\n    actions.showSnackbarMessage(i18n.t('Installing app from the app hub...'));\n    installAppVersion(versionId, d2).then(() => d2.system.reloadApps()).then(apps => {\n      actions.showSnackbarMessage(i18n.t('App installed successfully'));\n      const appHubState2 = appHubStore.getState();\n      appHubStore.setState(Object.assign(appHubState2, {\n        installing: appHubState2.installing - 1\n      }));\n      installedAppHub.setState(apps);\n      params.complete(apps);\n    }).catch(err => {\n      actions.showSnackbarMessage(`${i18n.t('Failed to install an app from the app hub')}: ${err.message}`);\n      appHubStore.setState(Object.assign(appHubStore.getState(), {\n        installing: appHubStore.getState().installing - 1\n      }));\n      log.error(err);\n    });\n  });\n});\n\nfunction installAppVersion(uid, d2) {\n  const api = d2.Api.getApi();\n  return new Promise((resolve, reject) => {\n    api.post(['appHub', uid].join('/'), '', {\n      dataType: 'text'\n    }).then(() => {\n      resolve();\n    }).catch(err => {\n      reject(err);\n    });\n  });\n}\n\nexport default actions;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Avatar from 'material-ui/Avatar';\nimport IconButton from 'material-ui/IconButton';\nimport IconMenu from 'material-ui/IconMenu';\nimport { List, ListItem } from 'material-ui/List';\nimport MenuItem from 'material-ui/MenuItem';\nimport { Card, CardText } from 'material-ui/Card';\nimport FloatingActionButton from 'material-ui/FloatingActionButton';\nimport FontIcon from 'material-ui/FontIcon';\nimport AppTheme from '../theme';\nimport actions from '../actions';\nimport i18n from '@dhis2/d2-i18n'; // const appTypeLabels = {\n//     app: 'Standard Apps',\n//     dashboard_widget: 'Dashboard Apps',\n//     tracker_dashboard_widget: 'Tracker Dashboard Apps',\n//     resource: 'Resource Apps',\n// }\n\nconst appTypeHeaders = {\n  app: 'Installed Standard Apps',\n  dashboard_widget: 'Installed Dashboard Apps',\n  tracker_dashboard_widget: 'Installed Tracker Dashboard Apps',\n  resource: 'Installed Resource Apps'\n};\nconst appTypeMissing = {\n  app: 'There are no standard apps installed.',\n  dashboard_widget: 'There are no dashboard apps installed.',\n  tracker_dashboard_widget: 'There are no tracker dashboard apps installed.',\n  resource: 'There are no resource apps installed'\n};\nconst styles = {\n  wrapper: {\n    maxWidth: 750,\n    position: 'relative'\n  },\n  header: {\n    fontSize: 24,\n    fontWeight: 300,\n    color: AppTheme.rawTheme.palette.textColor,\n    padding: '24px 0 12px 16px'\n  },\n  container: {\n    borderBottom: '1px solid #dddddd',\n    paddingBottom: 0,\n    marginBottom: 8\n  },\n  fab: {\n    position: 'absolute',\n    top: 45,\n    right: 32\n  },\n  fabAnim: {\n    float: 'right'\n  },\n  noApps: {\n    marginTop: 16,\n    padding: '16px 0 5px 16px',\n    fontWeight: 300,\n    fontSize: 15\n  },\n  app: {\n    borderTop: '1px solid #dddddd'\n  },\n  appName: {\n    padding: 16,\n    clear: 'both'\n  },\n  appLink: {\n    textDecoration: 'none'\n  },\n  appActions: {\n    display: 'inline-block',\n    float: 'right',\n    marginTop: -8,\n    marginRight: -16\n  },\n  appButtons: {\n    marginLeft: '1rem'\n  },\n  appIcon: {\n    borderRadius: 3\n  },\n  card: {\n    marginTop: 8,\n    marginRight: '1rem'\n  }\n};\n\nclass AppList extends React.Component {\n  constructor(props, context) {\n    super(props, context);\n    this.state = {\n      uploading: false\n    };\n    this.uploadAction = this.uploadAction.bind(this);\n    this.upload = this.upload.bind(this);\n  }\n\n  componentDidMount() {\n    actions.installApp.subscribe(() => {\n      if (this.form) {\n        this.form.reset();\n      }\n    });\n  }\n\n  uploadAction(e) {\n    this.fileInput.click(e);\n  }\n\n  upload(e) {\n    actions.installApp(e.target.files[0], this.props.uploadProgress);\n  }\n\n  renderInstalledApps() {\n    const label = this.props.appTypeFilter.toLocaleLowerCase();\n    const appList = this.props.installedApps.filter(app => !this.props.appTypeFilter || app.appType === this.props.appTypeFilter);\n\n    if (appList.length > 0) {\n      return <div>\n                    <div style={styles.header}>\n                        {i18n.t(appTypeHeaders[label])}\n                    </div>\n                    <Card style={styles.card}>\n                        <CardText>\n                            <List style={styles.container}>\n                                {appList.map(app => {\n                const uninstall = actions.uninstallApp.bind(null, app.key);\n                const moreIcon = <IconButton>\n                                            <FontIcon className=\"material-icons\" color=\"#808080\">\n                                                more_vert\n                                            </FontIcon>\n                                        </IconButton>;\n                const open = window.open.bind(null, app.launchUrl);\n                const rightIconButton = <IconMenu iconButtonElement={moreIcon}>\n                                            <MenuItem onClick={uninstall}>\n                                                Uninstall\n                                            </MenuItem>\n                                        </IconMenu>;\n                const avatar = app.icons && app.icons['48'] ? <Avatar style={styles.appIcon} src={[app.baseUrl, app.icons['48']].join('/')} /> : <Avatar backgroundColor={AppTheme.rawTheme.palette.primary1Color} icon={<FontIcon className=\"material-icons\">\n                                                        folder\n                                                    </FontIcon>} />;\n                const secondaryText = <div>\n                                            {app.isBundledApp && <strong>\n                                                    {i18n.t('CORE APP')}{' '}\n                                                </strong>}\n                                            v{app.version}\n                                        </div>;\n                return <ListItem key={app.folderName} primaryText={app.name} secondaryText={secondaryText} style={styles.app} onClick={open} leftAvatar={avatar} rightIconButton={rightIconButton} />;\n              })}\n                            </List>\n                        </CardText>\n                    </Card>\n                    {this.renderUploadButton()}\n                </div>;\n    }\n\n    return this.renderEmptyList();\n  }\n\n  renderEmptyList() {\n    const label = this.props.appTypeFilter.toLocaleLowerCase();\n    return <div>\n                <div style={styles.header}>{i18n.t(appTypeHeaders[label])}</div>\n                <div style={styles.noApps}>{i18n.t(appTypeMissing[label])}</div>\n                {this.renderUploadButton()}\n            </div>;\n  }\n\n  renderUploadButton() {\n    if (!this.props.showUpload) {\n      return null;\n    }\n\n    const setFormRef = ref => {\n      this.form = ref;\n    };\n\n    const theref = r => {\n      this.fileInput = r;\n    };\n\n    return <div>\n                <div style={styles.fab}>\n                    <div style={styles.fabAnim} className=\"fab\">\n                        <FloatingActionButton onClick={this.uploadAction}>\n                            <FontIcon className=\"material-icons\">\n                                file_upload\n                            </FontIcon>\n                        </FloatingActionButton>\n                    </div>\n                </div>\n                <form ref={setFormRef} style={{\n        visibility: 'hidden'\n      }}>\n                    <input type=\"file\" ref={theref} onChange={this.upload} />\n                </form>\n            </div>;\n  }\n\n  render() {\n    return <div style={styles.wrapper}>{this.renderInstalledApps()}</div>;\n  }\n\n}\n\nAppList.propTypes = {\n  appTypeFilter: PropTypes.oneOf(['APP', 'DASHBOARD_WIDGET', 'TRACKER_DASHBOARD_WIDGET', 'RESOURCE']).isRequired,\n  installedApps: PropTypes.array.isRequired,\n  showUpload: PropTypes.bool.isRequired,\n  uploadProgress: PropTypes.func.isRequired\n};\nAppList.defaultProps = {\n  appTypeFilter: 'app'\n};\nexport default AppList;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Card, CardActions, CardHeader, CardText } from 'material-ui/Card';\nimport FlatButton from 'material-ui/FlatButton';\nimport FontIcon from 'material-ui/FontIcon';\nimport Avatar from 'material-ui/Avatar';\nimport LoadingMask from 'd2-ui/lib/loading-mask/LoadingMask.component';\nimport AppTheme from '../theme';\nimport actions from '../actions';\nimport i18n from '@dhis2/d2-i18n';\n/*\n * Discontinued...\nfunction parseDescription(description) {\n    return {\n        __html: description\n        // Linkify email addresses\n            .replace(\n                /([\\w.]*\\w@[\\w.]*\\w\\.[a-zA-Z]{2,})/g,\n                '<a href=\"mailto:$1\" rel=\"nofollow\" target=\"_blank\">$1</a>'\n            )\n            // Linkify http:// and https:// links\n            .replace(/(https?:\\/\\/[\\w./]*)/g, '<a href=\"$1\" rel=\"nofollow\" target=\"_blank\">$1</a>')\n            // Convert newlines to HTML line breaks\n            .replace(/\\n/g, '\\n<br/>'),\n    };\n}\n*/\n\nclass AppHub extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      installing: undefined\n    };\n  }\n\n  UNSAFE_componentWillMount() {\n    if (!Array.isArray(this.props.appHub.apps)) {\n      actions.loadAppHub();\n    }\n  }\n\n  renderApps() {\n    const styles = {\n      card: {\n        width: 297,\n        float: 'left',\n        marginRight: '1rem',\n        marginBottom: '1rem'\n      },\n      cardTitle: {\n        background: '#5892BE',\n        fontWeight: 400\n      },\n      cardTitleSubtitle: {\n        color: '#CCDDEE',\n        fontWeight: 300,\n        fontSize: 13,\n        overflowX: 'hidden',\n        overflowY: 'hidden',\n        maxWidth: 205,\n        whiteSpace: 'nowrap',\n        textOverflow: 'ellipsis'\n      },\n      cardText: {\n        borderTop: '1px solid #c3c3c3',\n        borderBottom: '1px solid #c3c3c3',\n        height: 165,\n        overflowY: 'hidden'\n      },\n      actions: {\n        textAlign: 'right'\n      },\n      button: {\n        marginRight: 0,\n        marginLeft: 8\n      },\n      flex: {\n        display: 'flex',\n        flexWrap: 'wrap'\n      }\n    };\n    const avatar = <Avatar backgroundColor={AppTheme.rawTheme.palette.primary1Color} icon={<FontIcon className=\"material-icons\">folder</FontIcon>} />;\n    return <div style={styles.flex}>\n                {this.props.appHub.apps.map(app => <Card style={styles.card} key={app.name}>\n                        <CardHeader title={app.name} subtitle={`${i18n.t('By')} ${app.developer.organisation}`} avatar={avatar} style={styles.cardTitle} titleColor=\"white\" subtitleStyle={styles.cardTitleSubtitle} />\n                        <CardText style={styles.cardText}>\n                            {app.description}\n                        </CardText>\n                        <CardActions style={styles.actions}>\n                            {app.versions.map(version => {\n            const install = actions.installAppVersion.bind(null, version.id);\n            return <FlatButton key={version.id} style={styles.button} primary onClick={install} label={`${i18n.t('Install')} v${version.version}`} />;\n          })}\n                        </CardActions>\n                    </Card>)}\n            </div>;\n  }\n\n  render() {\n    const styles = {\n      loadingMaskContainer: {\n        position: 'fixed',\n        left: 256,\n        top: '3rem',\n        right: 0,\n        bottom: 0,\n        zIndex: 1000\n      },\n      header: {\n        fontSize: 24,\n        fontWeight: 300,\n        color: AppTheme.rawTheme.palette.textColor,\n        padding: '24px 0 12px 16px'\n      },\n      card: {\n        marginTop: 8,\n        marginRight: '1rem'\n      },\n      cardTitle: {\n        background: '#5892BE'\n      },\n      cardTitleText: {\n        color: 'white',\n        fontSize: 28,\n        fontWeight: 300\n      },\n      apps: {\n        paddingTop: '1rem'\n      },\n      description: {\n        padding: '1rem',\n        color: 'gray',\n        borderRadius: 3,\n        clear: 'both',\n        fontWeight: 300\n      }\n    };\n    return Array.isArray(this.props.appHub.apps) ? <div>\n                <div style={styles.header}>{i18n.t('App Hub')}</div>\n                <div style={styles.apps}>{this.renderApps()}</div>\n            </div> : <div style={styles.loadingMaskContainer}>\n                <LoadingMask />\n            </div>;\n  }\n\n}\n\nAppHub.propTypes = {\n  appHub: PropTypes.object.isRequired\n};\nAppHub.defaultProps = {\n  appHub: {}\n};\nexport default AppHub;","/* global __VERSION__ */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { NoticeBox, Button } from '@dhis2/ui';\nimport i18n from '@dhis2/d2-i18n';\nimport actions from '../actions';\nconst currentVersion = \"31.0.0\";\nconst appManagementAppOrg = 'DHIS2';\nconst appManagementAppName = 'App Management';\n\nconst parseVersion = versionString => versionString.split('.').map(Number);\n\nconst needsUpdate = (current, candidate) => {\n  const currentVersion = parseVersion(current);\n  const candidateVersion = parseVersion(candidate);\n  return currentVersion.some((v, i) => v < candidateVersion[i]);\n};\n\nconst getTargetVersion = (current, versions) => {\n  if (!versions) return null;\n  let targetVersion;\n  versions.forEach(candidate => {\n    if (needsUpdate(targetVersion?.version || current, candidate.version)) {\n      targetVersion = candidate;\n    }\n  });\n  return targetVersion;\n};\n\nexport const SelfUpdateNoticeBox = ({\n  appHub\n}) => {\n  if (!appHub.apps) return null;\n  const appManagementApp = appHub.apps.find(app => app.developer.organisation === appManagementAppOrg && app.name === appManagementAppName);\n  const targetVersion = getTargetVersion(currentVersion, appManagementApp?.versions);\n\n  if (!appManagementApp || !targetVersion) {\n    return null;\n  }\n\n  const upgradeSelf = async () => {\n    await actions.installAppVersion([targetVersion.id]).toPromise();\n    setTimeout(() => location.reload(), 500);\n  };\n\n  return <NoticeBox title={i18n.t('A new version of App Management is available on the App Hub')}>\n            <Button onClick={upgradeSelf}>\n                {i18n.t('Update and reload app')}\n            </Button>\n        </NoticeBox>;\n};\nSelfUpdateNoticeBox.propTypes = {\n  appHub: PropTypes.object.isRequired\n};","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Sidebar from 'd2-ui/lib/sidebar/Sidebar.component';\nimport CircularProgress from 'material-ui/CircularProgress';\nimport LinearProgress from 'material-ui/LinearProgress';\nimport { Card, CardText } from 'material-ui/Card';\nimport Snackbar from 'material-ui/Snackbar';\nimport FontIcon from 'material-ui/FontIcon';\nimport AppList from './AppList.component';\nimport AppHub from './AppHub.component';\nimport { SelfUpdateNoticeBox } from './SelfUpdateNoticeBox.component';\nimport AppTheme from '../theme';\nimport actions from '../actions';\nimport appHubStore from '../stores/appHub.store';\nimport installedAppHub from '../stores/installedApp.store';\nimport i18n from '@dhis2/d2-i18n';\nconst styles = {\n  header: {\n    fontSize: 24,\n    fontWeight: 300,\n    color: AppTheme.rawTheme.palette.textColor,\n    padding: '24px 0 12px 16px'\n  },\n  noApps: {\n    marginTop: 16,\n    padding: '16px 0 5px 16px',\n    fontWeight: 300,\n    fontSize: 15\n  },\n  progress: {\n    margin: '16px 1rem 16px 0',\n    padding: 16,\n    maxWidth: 734\n  },\n  installing: {\n    marginRight: '1rem',\n    paddingRight: '1rem',\n    marginTop: 16,\n    padding: 16,\n    textAlign: 'center',\n    fontSize: 14,\n    fontWeight: 300,\n    maxWidth: 734\n  },\n  snackbar: {\n    // left: '2rem',\n    right: 'initial'\n  },\n  menuLabel: {\n    position: 'relative',\n    top: -6,\n    marginLeft: 16\n  }\n};\n\nclass App extends React.Component {\n  constructor(props, context) {\n    super(props, context);\n    this.state = {\n      installedApps: [],\n      installing: false,\n      uploading: false,\n      progress: undefined,\n      appHub: {},\n      lastUpdate: null\n    } // Bind 'this' for functions that need it\n    ;\n    ['setSection', 'progress', 'closeSnackbar', 'showSnackbar', 'search'].forEach(fn => {\n      this[fn] = this[fn].bind(this);\n    });\n  }\n\n  getChildContext() {\n    return {\n      d2: this.props.d2,\n      muiTheme: AppTheme\n    };\n  }\n\n  componentDidMount() {\n    this.subscriptions = [installedAppHub.subscribe(installedApps => {\n      this.setState({\n        installedApps,\n        lastUpdate: new Date()\n      });\n    }), appHubStore.subscribe(appHub => {\n      this.setState({\n        appHub,\n        installing: appHub.installing !== undefined && appHub.installing > 0\n      });\n    }), actions.installApp.subscribe(() => {\n      this.setState({\n        uploading: true\n      });\n    }), actions.appInstalled.subscribe(({\n      data\n    }) => {\n      this.setState({\n        uploading: false\n      });\n      this.setSection(installedAppHub.getAppFromKey(data).appType.toLowerCase() || 'app');\n    }), actions.refreshApps.subscribe(() => {\n      this.setState({\n        uploading: false\n      });\n    }), actions.showSnackbarMessage.subscribe(params => {\n      if (this.state.snackbar) {\n        this.setState({\n          snackbar: undefined\n        });\n        setTimeout(() => {\n          this.setState({\n            snackbar: params.data\n          });\n        }, 150);\n      } else {\n        this.setState({\n          snackbar: params.data\n        });\n      }\n    }), actions.installAppVersion.subscribe(({\n      data\n    }) => {\n      const app = appHubStore.getAppFromVersionId(data[0]);\n      this.setSection(app.appType && app.appType.toLowerCase() || 'app');\n    })];\n    actions.loadAppHub();\n  }\n\n  componentWillUnmount() {\n    this.subscriptions.forEach(subscription => {\n      subscription.dispose();\n    });\n  }\n\n  setSection(key) {\n    if (this.sidebar) {\n      this.sidebar.clearSearchBox();\n    }\n\n    this.setState({\n      section: key,\n      appSearch: undefined\n    });\n  }\n\n  progress(p) {\n    if (p) {\n      if (p === 1) {\n        this.setState({\n          uploading: false,\n          progress: undefined\n        });\n      } else {\n        this.setState({\n          progress: p * 100\n        });\n      }\n    } else {\n      this.setState({\n        progress: undefined\n      });\n    }\n  }\n\n  closeSnackbar() {\n    this.setState({\n      snackbar: undefined\n    });\n  }\n\n  showSnackbar(message) {\n    this.setState({\n      snackbar: message\n    });\n  }\n\n  search(text) {\n    if (text.length > 0) {\n      this.setState({\n        appSearch: this.state.installedApps.filter(app => app.name.toLowerCase().indexOf(text.toLowerCase()) !== -1).sort((a, b) => a.appType.localeCompare(b.appType) || a.name.localeCompare(b.name)),\n        appSearchText: text\n      });\n    } else {\n      this.setState({\n        appSearch: undefined,\n        appSearchText: undefined\n      });\n    }\n  }\n\n  renderUploadProgress() {\n    if (this.state.uploading) {\n      return <Card style={styles.progress}>\n                    <CardText>\n                        {i18n.t('Uploading...')}\n                        <LinearProgress mode={this.state.progress ? 'determinate' : 'indeterminate'} color=\"#6688AA\" value={this.state.progress} />\n                    </CardText>\n                </Card>;\n    }\n\n    return null;\n  }\n\n  renderInstallProgress() {\n    if (this.state.installing) {\n      return <div style={styles.installing}>\n                    <CircularProgress mode=\"indeterminate\" color=\"#6688AA\" // size={0.75}\n        value={this.state.progress} />\n                    <br />\n                    <br />\n                    {i18n.t('Installing...')}\n                </div>;\n    }\n\n    return null;\n  }\n\n  renderSection(key, apps, showUpload) {\n    if (key === 'store') {\n      return <AppHub appHub={this.state.appHub} d2={this.props.d2} />;\n    }\n\n    const filter = key && key.toString().toUpperCase() || 'APP';\n    return <AppList d2={this.props.d2} installedApps={apps} uploadProgress={this.progress} transitionUnmount={this.state.unmountSection} showUpload={showUpload && !this.state.uploading} appHub={this.state.appHub} appTypeFilter={filter} />;\n  }\n\n  renderSearchResults() {\n    const appsByType = this.state.appSearch.reduce((types, app) => {\n      if (Object.prototype.hasOwnProperty.call(types, app.appType)) {\n        types[app.appType].push(app);\n      } else {\n        types[app.appType] = [app]; // eslint-disable-line\n      }\n\n      return types;\n    }, {});\n\n    if (Object.keys(appsByType).length) {\n      return Object.keys(appsByType).map((type, i) => <div key={type}>\n                    {this.renderSection(type, appsByType[type], i === 0)}\n                </div>);\n    }\n\n    return <div>\n                <div style={styles.header}>{i18n.t('No apps found')}</div>\n                <div style={styles.noApps}>\n                    {i18n.t('No installed apps matched the search term')} &quot;\n                    {this.state.appSearchText}&quot;\n                </div>\n            </div>;\n  }\n\n  render() {\n    const sections = [{\n      key: 'app',\n      icon: 'desktop_windows',\n      label: i18n.t('Standard Apps')\n    }, {\n      key: 'dashboard_widget',\n      icon: 'wallpaper',\n      label: i18n.t('Dashboard Apps')\n    }, {\n      key: 'tracker_dashboard_widget',\n      icon: 'supervisor_account',\n      label: i18n.t('Tracker Dashboard Apps')\n    }, {\n      key: 'resource',\n      icon: 'data_usage',\n      label: i18n.t('Resource Apps')\n    }, {\n      key: 'store',\n      icon: 'store',\n      label: i18n.t('App Hub')\n    }].map(section => ({\n      key: section.key,\n      label: section.label,\n      icon: <FontIcon className=\"material-icons\">{section.icon}</FontIcon>\n    }));\n\n    const reffer = r => {\n      this.sidebar = r;\n    };\n\n    return <div className=\"app\">\n                <SelfUpdateNoticeBox appHub={this.state.appHub} />\n                <Sidebar sections={sections} currentSection={this.state.section} onChangeSection={this.setSection} showSearchField onChangeSearchText={this.search} ref={reffer} />\n                <Snackbar message={this.state.snackbar || ''} autoHideDuration={2500} onRequestClose={this.closeSnackbar} open={!!this.state.snackbar} style={styles.snackbar} />\n                <div className=\"content-area\">\n                    {this.state.appSearch ? this.renderSearchResults() : this.renderSection(this.state.section, this.state.installedApps, true)}\n                    {this.renderUploadProgress()}\n                    {this.renderInstallProgress()}\n                </div>\n            </div>;\n  }\n\n}\n\nApp.propTypes = {\n  d2: PropTypes.object.isRequired\n};\nApp.childContextTypes = {\n  d2: PropTypes.object,\n  muiTheme: PropTypes.object\n};\nexport default App;","//------------------------------------------------------------------------------\n// <auto-generated>\n// This code was generated by d2-i18n-generate.\n//\n// Changes to this file may cause incorrect behavior and will be lost if\n// the code is regenerated.\n// </auto-generated>\n//------------------------------------------------------------------------------\nimport i18n from '@dhis2/d2-i18n';\nimport arTranslations from './ar/translations.json';\nimport csTranslations from './cs/translations.json';\nimport enTranslations from './en/translations.json';\nimport frTranslations from './fr/translations.json';\nimport idTranslations from './id/translations.json';\nimport nbTranslations from './nb/translations.json';\nimport ruTranslations from './ru/translations.json';\nimport svTranslations from './sv/translations.json';\nimport uzTranslations from './uz/translations.json';\nimport uz_CyrlTranslations from './uz_Cyrl/translations.json';\nimport uz_LatnTranslations from './uz_Latn/translations.json';\nimport viTranslations from './vi/translations.json';\nimport zhTranslations from './zh/translations.json';\nimport zh_CNTranslations from './zh_CN/translations.json';\nconst namespace = 'default';\ni18n.addResources('ar', namespace, arTranslations);\ni18n.addResources('cs', namespace, csTranslations);\ni18n.addResources('en', namespace, enTranslations);\ni18n.addResources('fr', namespace, frTranslations);\ni18n.addResources('id', namespace, idTranslations);\ni18n.addResources('nb', namespace, nbTranslations);\ni18n.addResources('ru', namespace, ruTranslations);\ni18n.addResources('sv', namespace, svTranslations);\ni18n.addResources('uz', namespace, uzTranslations);\ni18n.addResources('uz_Cyrl', namespace, uz_CyrlTranslations);\ni18n.addResources('uz_Latn', namespace, uz_LatnTranslations);\ni18n.addResources('vi', namespace, viTranslations);\ni18n.addResources('zh', namespace, zhTranslations);\ni18n.addResources('zh_CN', namespace, zh_CNTranslations);\nexport default i18n;","import React from 'react';\nimport MuiThemeProvider from 'material-ui/styles/MuiThemeProvider';\nimport { useD2 } from '@dhis2/app-runtime-adapter-d2';\nimport installedAppHub from './stores/installedApp.store';\nimport App from './components/App.component';\nimport theme from './theme';\nimport './locales';\nimport 'material-design-icons-iconfont/dist/material-design-icons.css';\nimport './scss/style.scss';\n\nconst AppWrapper = () => {\n  const {\n    d2\n  } = useD2({\n    onInitialized: d2 => {\n      installedAppHub.setState(d2.system.installedApps);\n    }\n  });\n\n  if (!d2) {\n    return null;\n  }\n\n  return <MuiThemeProvider muiTheme={theme}>\n            <App d2={d2} />\n        </MuiThemeProvider>;\n};\n\nexport default AppWrapper;"],"sourceRoot":""}