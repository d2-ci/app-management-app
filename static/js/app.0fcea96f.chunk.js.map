{"version":3,"sources":["D2App/stores/installedApp.store.js","D2App/theme.js","D2App/stores/appHub.store.js","D2App/actions.js","D2App/components/AppList.component.js","D2App/components/AppHub.component.js","D2App/components/SelfUpdateNoticeBox.component.js","D2App/components/App.component.js","D2App/locales/index.js","D2App/AppWrapper.js"],"names":["store","Store","create","getAppFromKey","appKey","apps","getState","i","length","key","theme","spacing","Spacing","fontFamily","palette","primary1Color","primary2Color","blue700","primary3Color","blue100","accent1Color","orange500","accent2Color","grey100","accent3Color","grey500","textColor","darkBlack","alternateTextColor","white","canvasColor","borderColor","grey400","disabledColor","fade","muiTheme","getMuiTheme","appTheme","style","sideBar","backgroundColor","backgroundColorItem","backgroundColorItemActive","textColorActive","borderStyle","forms","minWidth","maxWidth","createAppTheme","Object","assign","getAppFromVersionId","versionId","app","j","versions","id","version","debug","Debug","actions","installApp","Action","uninstallApp","refreshApps","appInstalled","loadAppHub","installAppVersion","showSnackbarMessage","wrapData","data","Array","isArray","subscribe","params","zipFile","progressCallback","getD2","then","d2","system","uploadApp","reloadApps","installedAppHub","setState","i18n","t","name","substring","lastIndexOf","complete","catch","err","message","log","error","async","baseUrl","Api","getApi","fetchOptions","credentials","headers","response","fetch","json","replace","getDhisVersion","appHubStore","appHubState","installing","uid","api","Promise","resolve","reject","post","join","dataType","appHubState2","appTypeHeaders","dashboard_widget","tracker_dashboard_widget","resource","appTypeMissing","styles","wrapper","position","header","fontSize","fontWeight","color","AppTheme","rawTheme","padding","container","borderBottom","paddingBottom","marginBottom","fab","top","right","fabAnim","float","noApps","marginTop","borderTop","appName","clear","appLink","textDecoration","appActions","display","marginRight","appButtons","marginLeft","appIcon","borderRadius","card","coreAppLabel","parseVersion","versionString","split","map","Number","latestAppVersion","appVersions","targetVersion","forEach","candidate","current","currentVersion","candidateVersion","needsUpdate","AppItem","latestVersion","handleUpdate","event","stopPropagation","toPromise","setTimeout","location","reload","moreIcon","className","rightIconButton","iconButtonElement","onClick","avatar","icons","src","icon","primaryText","_","e","dense","secondaryText","isBundledApp","List","window","open","launchUrl","leftAvatar","AppList","React","Component","constructor","props","context","super","uploadAction","this","fileInput","click","upload","target","files","uploadProgress","appHub","appHubData","find","appHubApp","developer","state","uploading","componentDidMount","form","reset","renderInstalledApps","label","appTypeFilter","toLocaleLowerCase","appList","installedApps","filter","appType","Card","folderName","renderUploadButton","renderEmptyList","showUpload","ref","visibility","type","r","onChange","render","defaultProps","AppHub","undefined","UNSAFE_componentWillMount","renderApps","width","cardTitle","background","cardTitleSubtitle","overflowX","overflowY","whiteSpace","textOverflow","cardText","height","textAlign","button","flex","flexWrap","title","subtitle","organisation","titleColor","subtitleStyle","description","primary","loadingMaskContainer","left","bottom","zIndex","cardTitleText","paddingTop","getTargetVersion","SelfUpdateNoticeBox","appManagementApp","progress","margin","paddingRight","snackbar","menuLabel","App","lastUpdate","fn","bind","getChildContext","subscriptions","Date","setSection","toLowerCase","wrapActionData","componentWillUnmount","subscription","dispose","sidebar","clearSearchBox","section","appSearch","p","closeSnackbar","showSnackbar","search","text","indexOf","sort","a","b","localeCompare","appSearchText","renderUploadProgress","mode","value","renderInstallProgress","renderSection","toString","toUpperCase","transitionUnmount","unmountSection","renderSearchResults","appsByType","reduce","types","prototype","hasOwnProperty","call","push","keys","sections","currentSection","onChangeSection","showSearchField","onChangeSearchText","autoHideDuration","onRequestClose","childContextTypes","PropTypes","object","addResources","arTranslations","csTranslations","enTranslations","frTranslations","idTranslations","nbTranslations","ruTranslations","svTranslations","uzTranslations","uz_CyrlTranslations","viTranslations","zhTranslations","zh_CNTranslations","AppWrapper","useD2","onInitialized"],"mappings":"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","file":"static/js/app.0fcea96f.chunk.js","sourcesContent":["import Store from 'd2-ui/lib/store/Store';\nconst store = Store.create();\n\nstore.getAppFromKey = appKey => {\n  const apps = store.getState();\n\n  for (let i = 0; i < apps.length; i++) {\n    if (apps[i].key === appKey) {\n      return apps[i];\n    }\n  }\n\n  return null;\n};\n\nexport default store;","import Spacing from 'material-ui/styles/spacing';\nimport getMuiTheme from 'material-ui/styles/getMuiTheme';\nimport { blue700, blue100, orange500, grey100, grey500, darkBlack, white, grey400 } from 'material-ui/styles/colors';\nimport { fade } from 'material-ui/utils/colorManipulator';\nconst theme = {\n  spacing: Spacing,\n  fontFamily: 'Roboto, sans-serif',\n  palette: {\n    primary1Color: '#276696',\n    primary2Color: blue700,\n    primary3Color: blue100,\n    accent1Color: orange500,\n    accent2Color: grey100,\n    accent3Color: grey500,\n    textColor: darkBlack,\n    alternateTextColor: white,\n    canvasColor: white,\n    borderColor: grey400,\n    disabledColor: fade(darkBlack, 0.3)\n  }\n};\n\nfunction createAppTheme(style) {\n  return {\n    sideBar: {\n      backgroundColor: '#F3F3F3',\n      backgroundColorItem: 'transparent',\n      backgroundColorItemActive: style.palette.accent2Color,\n      textColor: style.palette.textColor,\n      textColorActive: style.palette.primary1Color,\n      borderStyle: '1px solid #e1e1e1'\n    },\n    forms: {\n      minWidth: 350,\n      maxWidth: 900\n    }\n  };\n}\n\nconst muiTheme = getMuiTheme(theme);\nconst appTheme = createAppTheme(theme);\nexport default Object.assign({}, muiTheme, appTheme);","import Store from 'd2-ui/lib/store/Store';\nconst store = Store.create();\n\nfunction getAppFromVersionId(versionId) {\n  for (let i = 0; i < store.getState().apps.length; i++) {\n    const app = store.getState().apps[i];\n\n    for (let j = 0; j < app.versions.length; j++) {\n      if (app.versions[j].id === versionId) {\n        app.version = app.versions[j];\n        return app;\n      }\n    }\n  }\n\n  return null;\n}\n\nstore.getAppFromVersionId = getAppFromVersionId;\nexport default store;","import Debug from 'debug';\nimport Action from 'd2-ui/lib/action/Action';\nimport { getInstance as getD2 } from 'd2';\nimport log from 'loglevel';\nimport appHubStore from './stores/appHub.store';\nimport installedAppHub from './stores/installedApp.store';\nimport i18n from '@dhis2/d2-i18n';\nconst debug = Debug('app-management-app:frontend:client');\nconst actions = {\n  // App management actions\n  installApp: Action.create('Install App'),\n  uninstallApp: Action.create('Uninstall App'),\n  refreshApps: Action.create('Refresh Apps'),\n  appInstalled: Action.create('An app was installed'),\n  // App store actions\n  loadAppHub: Action.create('Load DHIS2 App Hub'),\n  installAppVersion: Action.create('Install App Version from DHIS2 App Hub'),\n  // Snackbar\n  showSnackbarMessage: Action.create('Show Snackbar message')\n};\nexport const wrapData = data => Array.isArray(data) ? data : [data];\n/*\n * Install app from zip file\n */\n\nactions.installApp.subscribe(params => {\n  const [zipFile, progressCallback] = wrapData(params.data);\n  getD2().then(d2 => {\n    d2.system.uploadApp(zipFile, progressCallback).then(() => d2.system.reloadApps()).then(apps => {\n      installedAppHub.setState(apps);\n      actions.showSnackbarMessage(i18n.t('App installed successfully'));\n      actions.appInstalled(zipFile.name.substring(0, zipFile.name.lastIndexOf('.')));\n      actions.refreshApps();\n      params.complete();\n    }).catch(err => {\n      let message = i18n.t('Failed to install app');\n\n      if (err.message) {\n        message += `: ${err.message}`;\n      }\n\n      actions.showSnackbarMessage(message);\n      log.error('Failed to install app:', err.message || err);\n      actions.refreshApps();\n    });\n  });\n});\n/*\n * Uninstall app\n */\n\nactions.uninstallApp.subscribe(params => {\n  const appKey = wrapData(params.data)[0];\n  getD2().then(d2 => {\n    d2.system.uninstallApp(appKey).then(() => {\n      actions.showSnackbarMessage(i18n.t('App removed successfully'));\n      actions.refreshApps();\n    });\n  });\n});\n/*\n * Refresh the list of installed apps\n */\n\nactions.refreshApps.subscribe(() => {\n  getD2().then(d2 => {\n    d2.system.reloadApps().then(apps => {\n      installedAppHub.setState(apps);\n    });\n  });\n});\n/*\n * Load the app hub\n */\n\nactions.loadAppHub.subscribe(async () => {\n  const d2 = await getD2();\n  const baseUrl = d2.Api.getApi().baseUrl;\n  debug(`Got baseUrl: ${baseUrl}`);\n  const fetchOptions = {\n    credentials: 'include',\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  };\n\n  const getDhisVersion = async () => {\n    const response = await fetch(`${baseUrl}/system/info`, fetchOptions);\n    const json = await response.json(); //if we're running a dev version remove the snapshot suffix to just keep the dhis version\n\n    return json.version.replace('-SNAPSHOT', '');\n  };\n\n  const version = await getDhisVersion();\n  debug(`Got dhis2 version: ${version}`);\n  const response = await fetch(`${baseUrl}/appHub/v1/apps?dhis_version=${version}`, fetchOptions);\n  const apps = await response.json();\n  appHubStore.setState(Object.assign(appHubStore.getState() || {}, {\n    apps\n  }));\n});\n/*\n * Install app version from the app hub\n */\n\nactions.installAppVersion.subscribe(params => {\n  const versionId = wrapData(params.data)[0];\n  const appHubState = appHubStore.getState();\n  appHubStore.setState(Object.assign(appHubState, {\n    installing: appHubState.installing ? appHubState.installing + 1 : 1\n  }));\n  getD2().then(d2 => {\n    actions.showSnackbarMessage(i18n.t('Installing app from the app hub...'));\n    installAppVersion(versionId, d2).then(() => d2.system.reloadApps()).then(apps => {\n      actions.showSnackbarMessage(i18n.t('App installed successfully'));\n      const appHubState2 = appHubStore.getState();\n      appHubStore.setState(Object.assign(appHubState2, {\n        installing: appHubState2.installing - 1\n      }));\n      installedAppHub.setState(apps);\n      params.complete(apps);\n    }).catch(err => {\n      actions.showSnackbarMessage(`${i18n.t('Failed to install an app from the app hub')}: ${err.message}`);\n      appHubStore.setState(Object.assign(appHubStore.getState(), {\n        installing: appHubStore.getState().installing - 1\n      }));\n      log.error(err);\n    });\n  });\n});\n\nfunction installAppVersion(uid, d2) {\n  const api = d2.Api.getApi();\n  return new Promise((resolve, reject) => {\n    api.post(['appHub', uid].join('/'), '', {\n      dataType: 'text'\n    }).then(() => {\n      resolve();\n    }).catch(err => {\n      reject(err);\n    });\n  });\n}\n\nexport default actions;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Avatar from 'material-ui/Avatar';\nimport IconButton from 'material-ui/IconButton';\nimport IconMenu from 'material-ui/IconMenu';\nimport { List, ListItem } from 'material-ui/List';\nimport MenuItem from 'material-ui/MenuItem';\nimport { Card, CardText } from 'material-ui/Card';\nimport FloatingActionButton from 'material-ui/FloatingActionButton';\nimport FontIcon from 'material-ui/FontIcon';\nimport { Chip } from '@dhis2/ui';\nimport AppTheme from '../theme';\nimport actions from '../actions';\nimport i18n from '@dhis2/d2-i18n';\nconst appTypeHeaders = {\n  app: 'Installed Standard Apps',\n  dashboard_widget: 'Installed Dashboard Apps',\n  tracker_dashboard_widget: 'Installed Tracker Dashboard Apps',\n  resource: 'Installed Resource Apps'\n};\nconst appTypeMissing = {\n  app: 'There are no standard apps installed.',\n  dashboard_widget: 'There are no dashboard apps installed.',\n  tracker_dashboard_widget: 'There are no tracker dashboard apps installed.',\n  resource: 'There are no resource apps installed'\n};\nconst styles = {\n  wrapper: {\n    maxWidth: 750,\n    position: 'relative'\n  },\n  header: {\n    fontSize: 24,\n    fontWeight: 300,\n    color: AppTheme.rawTheme.palette.textColor,\n    padding: '24px 0 12px 16px'\n  },\n  container: {\n    borderBottom: '1px solid #dddddd',\n    paddingBottom: 0,\n    marginBottom: 8\n  },\n  fab: {\n    position: 'absolute',\n    top: 45,\n    right: 32\n  },\n  fabAnim: {\n    float: 'right'\n  },\n  noApps: {\n    marginTop: 16,\n    padding: '16px 0 5px 16px',\n    fontWeight: 300,\n    fontSize: 15\n  },\n  app: {\n    borderTop: '1px solid #dddddd'\n  },\n  appName: {\n    padding: 16,\n    clear: 'both'\n  },\n  appLink: {\n    textDecoration: 'none'\n  },\n  appActions: {\n    display: 'inline-block',\n    float: 'right',\n    marginTop: -8,\n    marginRight: -16\n  },\n  appButtons: {\n    marginLeft: '1rem'\n  },\n  appIcon: {\n    borderRadius: 3\n  },\n  card: {\n    marginTop: 8,\n    marginRight: '1rem'\n  },\n  coreAppLabel: {\n    fontWeight: 'bold',\n    marginRight: '0.3em'\n  }\n};\n\nconst parseVersion = versionString => versionString.split('.').map(Number);\n\nconst needsUpdate = (current, candidate) => {\n  const currentVersion = parseVersion(current);\n  const candidateVersion = parseVersion(candidate);\n\n  for (let i = 0; i < 3; i++) {\n    const current = currentVersion[i];\n    const candidate = candidateVersion[i];\n\n    if (current != candidate) {\n      return current < candidate;\n    }\n  }\n\n  return false;\n};\n\nconst latestAppVersion = appVersions => {\n  let targetVersion = appVersions[0];\n  appVersions.forEach(candidate => {\n    if (needsUpdate(targetVersion.version, candidate.version)) {\n      targetVersion = candidate;\n    }\n  });\n  return targetVersion;\n};\n\nconst AppItem = ({\n  app,\n  appVersions\n}) => {\n  const latestVersion = appVersions ? latestAppVersion(appVersions) : null;\n  const needsUpdate = latestVersion !== null && latestVersion.version != app.version;\n\n  const handleUpdate = async event => {\n    event.stopPropagation();\n    await actions.installAppVersion(latestVersion.id).toPromise();\n\n    if (app.name === 'App Management') {\n      setTimeout(() => location.reload(), 500);\n    }\n  };\n\n  const handleUninstall = () => actions.uninstallApp(app.key);\n\n  const handleOpen = () => window.open(app.launchUrl);\n\n  const moreIcon = <IconButton>\n            <FontIcon className=\"material-icons\" color=\"#808080\">\n                more_vert\n            </FontIcon>\n        </IconButton>;\n  const rightIconButton = <IconMenu iconButtonElement={moreIcon}>\n            {needsUpdate && <MenuItem onClick={handleUpdate}>\n                    Update to v{latestVersion.version}\n                </MenuItem>}\n            <MenuItem onClick={handleUninstall}>Uninstall</MenuItem>\n        </IconMenu>;\n  const avatar = app.icons?.['48'] ? <Avatar style={styles.appIcon} src={[app.baseUrl, app.icons['48']].join('/')} /> : <Avatar backgroundColor={AppTheme.rawTheme.palette.primary1Color} icon={<FontIcon className=\"material-icons\">folder</FontIcon>} />;\n  const primaryText = <div>\n            {app.name}\n            {needsUpdate && <Chip onClick={(_, e) => handleUpdate(e)} dense>\n                    Update to v{latestVersion.version}\n                </Chip>}\n        </div>;\n  const secondaryText = <div>\n            {app.isBundledApp && <span style={styles.coreAppLabel}>{i18n.t('CORE APP')}</span>}\n            {`v${app.version}`}\n        </div>;\n  return <ListItem primaryText={primaryText} secondaryText={secondaryText} style={styles.app} onClick={handleOpen} leftAvatar={avatar} rightIconButton={rightIconButton} />;\n};\n\nAppItem.propTypes = {\n  app: PropTypes.object.isRequired,\n  appVersions: PropTypes.array\n};\n\nclass AppList extends React.Component {\n  constructor(props, context) {\n    super(props, context);\n    this.state = {\n      uploading: false\n    };\n  }\n\n  componentDidMount() {\n    actions.installApp.subscribe(() => {\n      if (this.form) {\n        this.form.reset();\n      }\n    });\n  }\n\n  uploadAction = e => {\n    this.fileInput.click(e);\n  };\n  upload = e => {\n    actions.installApp(e.target.files[0], this.props.uploadProgress);\n  };\n  appVersions = app => {\n    if (!this.props.appHub.apps) {\n      return null;\n    }\n\n    const appHubData = this.props.appHub.apps.find(appHubApp => appHubApp.name === app.name && (!app.developer || appHubApp.developer.name == app.developer?.name));\n    return appHubData?.versions;\n  };\n\n  renderInstalledApps() {\n    const label = this.props.appTypeFilter.toLocaleLowerCase();\n    const appList = this.props.installedApps.filter(app => !this.props.appTypeFilter || app.appType === this.props.appTypeFilter);\n\n    if (appList.length > 0) {\n      return <div>\n                    <div style={styles.header}>\n                        {i18n.t(appTypeHeaders[label])}\n                    </div>\n                    <Card style={styles.card}>\n                        <CardText>\n                            <List style={styles.container}>\n                                {appList.map(app => <AppItem key={app.folderName} app={app} appVersions={this.appVersions(app)} />)}\n                            </List>\n                        </CardText>\n                    </Card>\n                    {this.renderUploadButton()}\n                </div>;\n    }\n\n    return this.renderEmptyList();\n  }\n\n  renderEmptyList() {\n    const label = this.props.appTypeFilter.toLocaleLowerCase();\n    return <div>\n                <div style={styles.header}>{i18n.t(appTypeHeaders[label])}</div>\n                <div style={styles.noApps}>{i18n.t(appTypeMissing[label])}</div>\n                {this.renderUploadButton()}\n            </div>;\n  }\n\n  renderUploadButton() {\n    if (!this.props.showUpload) {\n      return null;\n    }\n\n    const setFormRef = ref => {\n      this.form = ref;\n    };\n\n    const theref = r => {\n      this.fileInput = r;\n    };\n\n    return <div>\n                <div style={styles.fab}>\n                    <div style={styles.fabAnim} className=\"fab\">\n                        <FloatingActionButton onClick={this.uploadAction}>\n                            <FontIcon className=\"material-icons\">\n                                file_upload\n                            </FontIcon>\n                        </FloatingActionButton>\n                    </div>\n                </div>\n                <form ref={setFormRef} style={{\n        visibility: 'hidden'\n      }}>\n                    <input type=\"file\" ref={theref} onChange={this.upload} />\n                </form>\n            </div>;\n  }\n\n  render() {\n    return <div style={styles.wrapper}>{this.renderInstalledApps()}</div>;\n  }\n\n}\n\nAppList.propTypes = {\n  appHub: PropTypes.object.isRequired,\n  appTypeFilter: PropTypes.oneOf(['APP', 'DASHBOARD_WIDGET', 'TRACKER_DASHBOARD_WIDGET', 'RESOURCE']).isRequired,\n  installedApps: PropTypes.array.isRequired,\n  showUpload: PropTypes.bool.isRequired,\n  uploadProgress: PropTypes.func.isRequired\n};\nAppList.defaultProps = {\n  appTypeFilter: 'app'\n};\nexport default AppList;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Card, CardActions, CardHeader, CardText } from 'material-ui/Card';\nimport FlatButton from 'material-ui/FlatButton';\nimport FontIcon from 'material-ui/FontIcon';\nimport Avatar from 'material-ui/Avatar';\nimport LoadingMask from 'd2-ui/lib/loading-mask/LoadingMask.component';\nimport AppTheme from '../theme';\nimport actions from '../actions';\nimport i18n from '@dhis2/d2-i18n';\n\nclass AppHub extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      installing: undefined\n    };\n  }\n\n  UNSAFE_componentWillMount() {\n    if (!Array.isArray(this.props.appHub.apps)) {\n      actions.loadAppHub();\n    }\n  }\n\n  renderApps() {\n    const styles = {\n      card: {\n        width: 297,\n        float: 'left',\n        marginRight: '1rem',\n        marginBottom: '1rem'\n      },\n      cardTitle: {\n        background: '#5892BE',\n        fontWeight: 400\n      },\n      cardTitleSubtitle: {\n        color: '#CCDDEE',\n        fontWeight: 300,\n        fontSize: 13,\n        overflowX: 'hidden',\n        overflowY: 'hidden',\n        maxWidth: 205,\n        whiteSpace: 'nowrap',\n        textOverflow: 'ellipsis'\n      },\n      cardText: {\n        borderTop: '1px solid #c3c3c3',\n        borderBottom: '1px solid #c3c3c3',\n        height: 165,\n        overflowY: 'hidden'\n      },\n      actions: {\n        textAlign: 'right'\n      },\n      button: {\n        marginRight: 0,\n        marginLeft: 8\n      },\n      flex: {\n        display: 'flex',\n        flexWrap: 'wrap'\n      }\n    };\n    const avatar = <Avatar backgroundColor={AppTheme.rawTheme.palette.primary1Color} icon={<FontIcon className=\"material-icons\">folder</FontIcon>} />;\n    return <div style={styles.flex}>\n                {this.props.appHub.apps.map(app => <Card style={styles.card} key={app.name}>\n                        <CardHeader title={app.name} subtitle={`${i18n.t('By')} ${app.developer.organisation}`} avatar={avatar} style={styles.cardTitle} titleColor=\"white\" subtitleStyle={styles.cardTitleSubtitle} />\n                        <CardText style={styles.cardText}>\n                            {app.description}\n                        </CardText>\n                        <CardActions style={styles.actions}>\n                            {app.versions.map(version => {\n            const handleInstall = () => actions.installAppVersion(version.id);\n\n            return <FlatButton key={version.id} style={styles.button} primary onClick={handleInstall} label={`${i18n.t('Install')} v${version.version}`} />;\n          })}\n                        </CardActions>\n                    </Card>)}\n            </div>;\n  }\n\n  render() {\n    const styles = {\n      loadingMaskContainer: {\n        position: 'fixed',\n        left: 256,\n        top: '3rem',\n        right: 0,\n        bottom: 0,\n        zIndex: 1000\n      },\n      header: {\n        fontSize: 24,\n        fontWeight: 300,\n        color: AppTheme.rawTheme.palette.textColor,\n        padding: '24px 0 12px 16px'\n      },\n      card: {\n        marginTop: 8,\n        marginRight: '1rem'\n      },\n      cardTitle: {\n        background: '#5892BE'\n      },\n      cardTitleText: {\n        color: 'white',\n        fontSize: 28,\n        fontWeight: 300\n      },\n      apps: {\n        paddingTop: '1rem'\n      },\n      description: {\n        padding: '1rem',\n        color: 'gray',\n        borderRadius: 3,\n        clear: 'both',\n        fontWeight: 300\n      }\n    };\n    return Array.isArray(this.props.appHub.apps) ? <div>\n                <div style={styles.header}>{i18n.t('App Hub')}</div>\n                <div style={styles.apps}>{this.renderApps()}</div>\n            </div> : <div style={styles.loadingMaskContainer}>\n                <LoadingMask />\n            </div>;\n  }\n\n}\n\nAppHub.propTypes = {\n  appHub: PropTypes.object.isRequired\n};\nAppHub.defaultProps = {\n  appHub: {}\n};\nexport default AppHub;","/* global __VERSION__ */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { NoticeBox, Button } from '@dhis2/ui';\nimport i18n from '@dhis2/d2-i18n';\nimport actions from '../actions';\nconst currentVersion = \"31.0.0\";\nconst appManagementAppOrg = 'DHIS2';\nconst appManagementAppName = 'App Management';\n\nconst parseVersion = versionString => versionString.split('.').map(Number);\n\nconst needsUpdate = (current, candidate) => {\n  const currentVersion = parseVersion(current);\n  const candidateVersion = parseVersion(candidate);\n\n  for (let i = 0; i < 3; i++) {\n    const current = currentVersion[i];\n    const candidate = candidateVersion[i];\n\n    if (current != candidate) {\n      return current < candidate;\n    }\n  }\n\n  return false;\n};\n\nconst getTargetVersion = (current, versions) => {\n  if (!versions) return null;\n  let targetVersion;\n  versions.forEach(candidate => {\n    if (needsUpdate(targetVersion?.version || current, candidate.version)) {\n      targetVersion = candidate;\n    }\n  });\n  return targetVersion;\n};\n\nconst SelfUpdateNoticeBox = ({\n  appHub\n}) => {\n  if (!appHub.apps) return null;\n  const appManagementApp = appHub.apps.find(app => app.developer.organisation === appManagementAppOrg && app.name === appManagementAppName);\n  const targetVersion = getTargetVersion(currentVersion, appManagementApp?.versions);\n\n  if (!appManagementApp || !targetVersion) {\n    return null;\n  }\n\n  const upgradeSelf = async () => {\n    await actions.installAppVersion(targetVersion.id).toPromise();\n    setTimeout(() => location.reload(), 500);\n  };\n\n  return <NoticeBox title={i18n.t('A new version of App Management is available on the App Hub')}>\n            <Button onClick={upgradeSelf}>\n                {i18n.t('Update and reload app')}\n            </Button>\n        </NoticeBox>;\n};\n\nSelfUpdateNoticeBox.propTypes = {\n  appHub: PropTypes.object.isRequired\n};\nexport default SelfUpdateNoticeBox;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Sidebar from 'd2-ui/lib/sidebar/Sidebar.component';\nimport CircularProgress from 'material-ui/CircularProgress';\nimport LinearProgress from 'material-ui/LinearProgress';\nimport { Card, CardText } from 'material-ui/Card';\nimport Snackbar from 'material-ui/Snackbar';\nimport FontIcon from 'material-ui/FontIcon';\nimport AppList from './AppList.component';\nimport AppHub from './AppHub.component';\nimport SelfUpdateNoticeBox from './SelfUpdateNoticeBox.component';\nimport AppTheme from '../theme';\nimport actions, { wrapData as wrapActionData } from '../actions';\nimport appHubStore from '../stores/appHub.store';\nimport installedAppHub from '../stores/installedApp.store';\nimport i18n from '@dhis2/d2-i18n';\nconst styles = {\n  header: {\n    fontSize: 24,\n    fontWeight: 300,\n    color: AppTheme.rawTheme.palette.textColor,\n    padding: '24px 0 12px 16px'\n  },\n  noApps: {\n    marginTop: 16,\n    padding: '16px 0 5px 16px',\n    fontWeight: 300,\n    fontSize: 15\n  },\n  progress: {\n    margin: '16px 1rem 16px 0',\n    padding: 16,\n    maxWidth: 734\n  },\n  installing: {\n    marginRight: '1rem',\n    paddingRight: '1rem',\n    marginTop: 16,\n    padding: 16,\n    textAlign: 'center',\n    fontSize: 14,\n    fontWeight: 300,\n    maxWidth: 734\n  },\n  snackbar: {\n    // left: '2rem',\n    right: 'initial'\n  },\n  menuLabel: {\n    position: 'relative',\n    top: -6,\n    marginLeft: 16\n  }\n};\n\nclass App extends React.Component {\n  constructor(props, context) {\n    super(props, context);\n    this.state = {\n      installedApps: [],\n      installing: false,\n      uploading: false,\n      progress: undefined,\n      appHub: {},\n      lastUpdate: null\n    } // Bind 'this' for functions that need it\n    ;\n    ['setSection', 'progress', 'closeSnackbar', 'showSnackbar', 'search'].forEach(fn => {\n      this[fn] = this[fn].bind(this);\n    });\n  }\n\n  getChildContext() {\n    return {\n      d2: this.props.d2,\n      muiTheme: AppTheme\n    };\n  }\n\n  componentDidMount() {\n    this.subscriptions = [installedAppHub.subscribe(installedApps => {\n      this.setState({\n        installedApps,\n        lastUpdate: new Date()\n      });\n    }), appHubStore.subscribe(appHub => {\n      this.setState({\n        appHub,\n        installing: appHub.installing !== undefined && appHub.installing > 0\n      });\n    }), actions.installApp.subscribe(() => {\n      this.setState({\n        uploading: true\n      });\n    }), actions.appInstalled.subscribe(({\n      data\n    }) => {\n      this.setState({\n        uploading: false\n      });\n      this.setSection(installedAppHub.getAppFromKey(data).appType.toLowerCase() || 'app');\n    }), actions.refreshApps.subscribe(() => {\n      this.setState({\n        uploading: false\n      });\n    }), actions.showSnackbarMessage.subscribe(params => {\n      if (this.state.snackbar) {\n        this.setState({\n          snackbar: undefined\n        });\n        setTimeout(() => {\n          this.setState({\n            snackbar: params.data\n          });\n        }, 150);\n      } else {\n        this.setState({\n          snackbar: params.data\n        });\n      }\n    }), actions.installAppVersion.subscribe(({\n      data\n    }) => {\n      const app = appHubStore.getAppFromVersionId(wrapActionData(data)[0]);\n      this.setSection(app.appType && app.appType.toLowerCase() || 'app');\n    })];\n    actions.loadAppHub();\n  }\n\n  componentWillUnmount() {\n    this.subscriptions.forEach(subscription => {\n      subscription.dispose();\n    });\n  }\n\n  setSection(key) {\n    if (this.sidebar) {\n      this.sidebar.clearSearchBox();\n    }\n\n    this.setState({\n      section: key,\n      appSearch: undefined\n    });\n  }\n\n  progress(p) {\n    if (p) {\n      if (p === 1) {\n        this.setState({\n          uploading: false,\n          progress: undefined\n        });\n      } else {\n        this.setState({\n          progress: p * 100\n        });\n      }\n    } else {\n      this.setState({\n        progress: undefined\n      });\n    }\n  }\n\n  closeSnackbar() {\n    this.setState({\n      snackbar: undefined\n    });\n  }\n\n  showSnackbar(message) {\n    this.setState({\n      snackbar: message\n    });\n  }\n\n  search(text) {\n    if (text.length > 0) {\n      this.setState({\n        appSearch: this.state.installedApps.filter(app => app.name.toLowerCase().indexOf(text.toLowerCase()) !== -1).sort((a, b) => a.appType.localeCompare(b.appType) || a.name.localeCompare(b.name)),\n        appSearchText: text\n      });\n    } else {\n      this.setState({\n        appSearch: undefined,\n        appSearchText: undefined\n      });\n    }\n  }\n\n  renderUploadProgress() {\n    if (this.state.uploading) {\n      return <Card style={styles.progress}>\n                    <CardText>\n                        {i18n.t('Uploading...')}\n                        <LinearProgress mode={this.state.progress ? 'determinate' : 'indeterminate'} color=\"#6688AA\" value={this.state.progress} />\n                    </CardText>\n                </Card>;\n    }\n\n    return null;\n  }\n\n  renderInstallProgress() {\n    if (this.state.installing) {\n      return <div style={styles.installing}>\n                    <CircularProgress mode=\"indeterminate\" color=\"#6688AA\" value={this.state.progress} />\n                    <br />\n                    <br />\n                    {i18n.t('Installing...')}\n                </div>;\n    }\n\n    return null;\n  }\n\n  renderSection(key, apps, showUpload) {\n    if (key === 'store') {\n      return <AppHub appHub={this.state.appHub} d2={this.props.d2} />;\n    }\n\n    const filter = key && key.toString().toUpperCase() || 'APP';\n    return <AppList d2={this.props.d2} installedApps={apps} uploadProgress={this.progress} transitionUnmount={this.state.unmountSection} showUpload={showUpload && !this.state.uploading} appHub={this.state.appHub} appTypeFilter={filter} />;\n  }\n\n  renderSearchResults() {\n    const appsByType = this.state.appSearch.reduce((types, app) => {\n      if (Object.prototype.hasOwnProperty.call(types, app.appType)) {\n        types[app.appType].push(app);\n      } else {\n        types[app.appType] = [app]; // eslint-disable-line\n      }\n\n      return types;\n    }, {});\n\n    if (Object.keys(appsByType).length) {\n      return Object.keys(appsByType).map((type, i) => <div key={type}>\n                    {this.renderSection(type, appsByType[type], i === 0)}\n                </div>);\n    }\n\n    return <div>\n                <div style={styles.header}>{i18n.t('No apps found')}</div>\n                <div style={styles.noApps}>\n                    {i18n.t('No installed apps matched the search term')} &quot;\n                    {this.state.appSearchText}&quot;\n                </div>\n            </div>;\n  }\n\n  render() {\n    const sections = [{\n      key: 'app',\n      icon: 'desktop_windows',\n      label: i18n.t('Standard Apps')\n    }, {\n      key: 'dashboard_widget',\n      icon: 'wallpaper',\n      label: i18n.t('Dashboard Apps')\n    }, {\n      key: 'tracker_dashboard_widget',\n      icon: 'supervisor_account',\n      label: i18n.t('Tracker Dashboard Apps')\n    }, {\n      key: 'resource',\n      icon: 'data_usage',\n      label: i18n.t('Resource Apps')\n    }, {\n      key: 'store',\n      icon: 'store',\n      label: i18n.t('App Hub')\n    }].map(section => ({\n      key: section.key,\n      label: section.label,\n      icon: <FontIcon className=\"material-icons\">{section.icon}</FontIcon>\n    }));\n\n    const reffer = r => {\n      this.sidebar = r;\n    };\n\n    return <div className=\"app\">\n                <SelfUpdateNoticeBox appHub={this.state.appHub} />\n                <Sidebar sections={sections} currentSection={this.state.section} onChangeSection={this.setSection} showSearchField onChangeSearchText={this.search} ref={reffer} />\n                <Snackbar message={this.state.snackbar || ''} autoHideDuration={2500} onRequestClose={this.closeSnackbar} open={!!this.state.snackbar} style={styles.snackbar} />\n                <div className=\"content-area\">\n                    {this.state.appSearch ? this.renderSearchResults() : this.renderSection(this.state.section, this.state.installedApps, true)}\n                    {this.renderUploadProgress()}\n                    {this.renderInstallProgress()}\n                </div>\n            </div>;\n  }\n\n}\n\nApp.propTypes = {\n  d2: PropTypes.object.isRequired\n};\nApp.childContextTypes = {\n  d2: PropTypes.object,\n  muiTheme: PropTypes.object\n};\nexport default App;","//------------------------------------------------------------------------------\n// <auto-generated>\n// This code was generated by d2-i18n-generate.\n//\n// Changes to this file may cause incorrect behavior and will be lost if\n// the code is regenerated.\n// </auto-generated>\n//------------------------------------------------------------------------------\nimport i18n from '@dhis2/d2-i18n';\nimport arTranslations from './ar/translations.json';\nimport csTranslations from './cs/translations.json';\nimport enTranslations from './en/translations.json';\nimport frTranslations from './fr/translations.json';\nimport idTranslations from './id/translations.json';\nimport nbTranslations from './nb/translations.json';\nimport ruTranslations from './ru/translations.json';\nimport svTranslations from './sv/translations.json';\nimport uzTranslations from './uz/translations.json';\nimport uz_CyrlTranslations from './uz_Cyrl/translations.json';\nimport viTranslations from './vi/translations.json';\nimport zhTranslations from './zh/translations.json';\nimport zh_CNTranslations from './zh_CN/translations.json';\nconst namespace = 'default';\ni18n.addResources('ar', namespace, arTranslations);\ni18n.addResources('cs', namespace, csTranslations);\ni18n.addResources('en', namespace, enTranslations);\ni18n.addResources('fr', namespace, frTranslations);\ni18n.addResources('id', namespace, idTranslations);\ni18n.addResources('nb', namespace, nbTranslations);\ni18n.addResources('ru', namespace, ruTranslations);\ni18n.addResources('sv', namespace, svTranslations);\ni18n.addResources('uz', namespace, uzTranslations);\ni18n.addResources('uz_Cyrl', namespace, uz_CyrlTranslations);\ni18n.addResources('vi', namespace, viTranslations);\ni18n.addResources('zh', namespace, zhTranslations);\ni18n.addResources('zh_CN', namespace, zh_CNTranslations);\nexport default i18n;","import React from 'react';\nimport MuiThemeProvider from 'material-ui/styles/MuiThemeProvider';\nimport { useD2 } from '@dhis2/app-runtime-adapter-d2';\nimport installedAppHub from './stores/installedApp.store';\nimport App from './components/App.component';\nimport theme from './theme';\nimport './locales';\nimport 'material-design-icons-iconfont/dist/material-design-icons.css';\nimport './scss/style.scss';\n\nconst AppWrapper = () => {\n  const {\n    d2\n  } = useD2({\n    onInitialized: d2 => {\n      installedAppHub.setState(d2.system.installedApps);\n    }\n  });\n\n  if (!d2) {\n    return null;\n  }\n\n  return <MuiThemeProvider muiTheme={theme}>\n            <App d2={d2} />\n        </MuiThemeProvider>;\n};\n\nexport default AppWrapper;"],"sourceRoot":""}