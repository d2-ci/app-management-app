(this["webpackJsonp@dhis2/app-shell"]=this["webpackJsonp@dhis2/app-shell"]||[]).push([[127],{726:function(e){e.exports=JSON.parse('{"App installed successfully":"\u062a\u0645 \u062a\u062b\u0628\u064a\u062a \u0627\u0644\u062a\u0637\u0628\u064a\u0642 \u0628\u0646\u062c\u0627\u062d","Failed to install app":"\u0641\u0634\u0644 \u062a\u062b\u0628\u064a\u062a \u0627\u0644\u062a\u0637\u0628\u064a\u0642","App removed successfully":"\u062a\u0645 \u0625\u0632\u0627\u0644\u0629 \u0627\u0644\u062a\u0637\u0628\u064a\u0642 \u0628\u0646\u062c\u0627\u062d","Installing app from the app hub...":"\u062a\u062b\u0628\u064a\u062a \u0627\u0644\u062a\u0637\u0628\u064a\u0642 \u0645\u0646 \u0645\u0631\u0643\u0632 \u0627\u0644\u062a\u0637\u0628\u064a\u0642\u0627\u062a...","Failed to install an app from the app hub":"\u0641\u0634\u0644 \u062a\u062b\u0628\u064a\u062a \u062a\u0637\u0628\u064a\u0642 \u0645\u0646 \u0645\u0631\u0643\u0632 \u0627\u0644\u062a\u0637\u0628\u064a\u0642\u0627\u062a","Uploading...":"\u0631\u0641\u0639...","Installing...":"\u062a\u062b\u0628\u064a\u062a...","No apps found":"\u0644\u0645 \u064a\u062a\u0645 \u0627\u0644\u0639\u062b\u0648\u0631 \u0639\u0644\u0649 \u062a\u0637\u0628\u064a\u0642\u0627\u062a","No installed apps matched the search term":"\u0644\u0627 \u062a\u0648\u062c\u062f \u062a\u0637\u0628\u064a\u0642\u0627\u062a \u0645\u062b\u0628\u062a\u0629 \u062a\u0637\u0627\u0628\u0642 \u0645\u0635\u0637\u0644\u062d \u0627\u0644\u0628\u062d\u062b","Standard Apps":"\u0627\u0644\u062a\u0637\u0628\u064a\u0642\u0627\u062a \u0627\u0644\u0642\u064a\u0627\u0633\u064a\u0629","Dashboard Apps":"\u062a\u0637\u0628\u064a\u0642\u0627\u062a \u0644\u0648\u062d\u0629 \u0627\u0644\u0645\u0639\u0644\u0648\u0645\u0627\u062a","Tracker Dashboard Apps":"\u062a\u0637\u0628\u064a\u0642\u0627\u062a \u0644\u0648\u062d\u0629 \u0645\u0639\u0644\u0648\u0645\u0627\u062a \u0627\u0644\u0645\u062a\u062a\u0628\u0639","Resource Apps":"\u062a\u0637\u0628\u064a\u0642\u0627\u062a \u0627\u0644\u0645\u0648\u0627\u0631\u062f","App Hub":"\u0645\u0631\u0643\u0632 \u0627\u0644\u062a\u0637\u0628\u064a\u0642","By":"\u0639\u0646 \u0637\u0631\u064a\u0642","Install":"\u062a\u062b\u0628\u064a\u062a"}')},727:function(e){e.exports=JSON.parse('{"App installed successfully":"","Failed to install app":"","App removed successfully":"","Installing app from the app hub...":"","Failed to install an app from the app hub":"","Uploading...":"","Installing...":"","No apps found":"","No installed apps matched the search term":"","Standard Apps":"","Dashboard Apps":"","Tracker Dashboard Apps":"","Resource Apps":"","App Hub":"","By":"","Install":"","CORE APP":"","A new version of App Management is available on the App Hub":"","Update and reload app":""}')},728:function(e){e.exports=JSON.parse('{"App installed successfully":"L\'appli a \xe9t\xe9 install\xe9e avec succ\xe8s","Failed to install app":"\xc9chec de l\'installation de l\'appli","App removed successfully":"Suppression de l\'appli r\xe9ussie","Installing app from the app hub...":"","Failed to install an app from the app hub":"","Uploading...":"T\xe9l\xe9chargement en cours...","Installing...":"Installation en cours...","No apps found":"Aucune appli trouv\xe9e","No installed apps matched the search term":"Aucune appli install\xe9e ne correspond au terme de recherche","Standard Apps":"Applis standards","Dashboard Apps":"Applis Tableau de bord","Tracker Dashboard Apps":"Applis Tableau de bord Tracker","Resource Apps":"Applis Ressources","App Hub":"","By":"Par","Install":"Installer"}')},729:function(e){e.exports=JSON.parse('{"App installed successfully":"App berhasil dipasang","Failed to install app":"Gagal memasang app","App removed successfully":"App berhasil dibuang","Installing app from the app hub...":"Sedang memasang app dari app hub...","Failed to install an app from the app hub":"Gagal memasang app dari app hub","Uploading...":"Sedang mengunggah...","Installing...":"Sedang memasang...","No apps found":"Tidak ditemukan apps","No installed apps matched the search term":"Tidak ada apps terpasang yang sesuai dengan pencarian","Standard Apps":"Standard Apps","Dashboard Apps":"Dashboard Apps","Tracker Dashboard Apps":"Tracker Dashboard Apps","Resource Apps":"Resource Apps","App Hub":"App Hub","By":"Oleh","Install":"Pasang"}')},730:function(e){e.exports=JSON.parse('{"App installed successfully":"Applikasjonen ble installert","Failed to install app":"Kunne ikke installere applikasjonen","App removed successfully":"Applikasjonen ble fjernet","Installing app from the app hub...":"Installerer applikasjon fra app hub...","Failed to install an app from the app hub":"Kunne ikke installere applikasjon fra app hub","Uploading...":"Laster opp...","Installing...":"Installerer...","No apps found":"Ingen applikasjoner funnet","No installed apps matched the search term":"Ingen installerte applikasjoner samsvarte med s\xf8keordet","Standard Apps":"Standardapplikasjoner","Dashboard Apps":"Dashbord-applikasjoner","Tracker Dashboard Apps":"Tracker Dashbord-applikasjoner","Resource Apps":"Ressurs-applikasjoner","App Hub":"App Hub","By":"Av","Install":"Installer"}')},731:function(e){e.exports=JSON.parse('{"App installed successfully":"\u041f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e","Failed to install app":"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435","App removed successfully":"\u041f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0443\u0434\u0430\u043b\u0435\u043d\u043e","Installing app from the app hub...":"","Failed to install an app from the app hub":"","Uploading...":"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 ...","Installing...":"\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 ...","No apps found":"\u041f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u044b","No installed apps matched the search term":"\u041d\u0435\u0442 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439, \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0445 \u0437\u0430\u043f\u0440\u043e\u0441\u0443","Standard Apps":"\u0421\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0435 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f","Dashboard Apps":"\u041f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u043f\u0430\u043d\u0435\u043b\u0438 \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u043e\u0432","Tracker Dashboard Apps":"\u041f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f Tracker Dashboard Apps","Resource Apps":"\u041f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f Resource Apps","App Hub":"","By":"\u041f\u043e","Install":"\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c"}')},732:function(e){e.exports=JSON.parse('{"App installed successfully":"App installerats","Failed to install app":"Det gick inte att installera appen","App removed successfully":"Appen har tagits bort","Installing app from the app hub...":"","Failed to install an app from the app hub":"","Uploading...":"Laddar upp ...","Installing...":"Installerar ...","No apps found":"Inga appar hittade","No installed apps matched the search term":"Inga installerade appar matchade s\xf6kordet","Standard Apps":"Standardapps","Dashboard Apps":"Dashboard Apps","Tracker Dashboard Apps":"Tracker Dashboard Apps","Resource Apps":"Resurs apps","App Hub":"","By":"Av","Install":"Installera"}')},733:function(e){e.exports=JSON.parse('{"App installed successfully":"\u1ee8ng d\u1ee5ng \u0111\xe3 c\xe0i \u0111\u1eb7t TH\xc0NH C\xd4NG","Failed to install app":"C\xe0i \u0111\u1eb7t \u1ee9ng d\u1ee5ng KH\xd4NG TH\xc0NH C\xd4NG","App removed successfully":"G\u1ee1 b\u1ecf \u1ee9ng d\u1ee5ng TH\xc0NH C\xd4NG","Installing app from the app hub...":"","Failed to install an app from the app hub":"","Uploading...":"\u0110ang t\u1ea3i l\xean","Installing...":"\u0110ang c\xe0i \u0111\u1eb7t...","No apps found":"Kh\xf4ng t\xecm th\u1ea5y \u1ee9ng d\u1ee5ng","No installed apps matched the search term":"Kh\xf4ng t\xecm th\u1ea5y \u1ee9ng d\u1ee5ng \u0111\xe3 c\xe0i \u0111\u1eb7t theo y\xeau c\u1ea7u","Standard Apps":"\u1ee8ng d\u1ee5ng chu\u1ea9n","Dashboard Apps":"\u1ee8ng d\u1ee5ng b\u1ea3ng th\xf4ng tin","Tracker Dashboard Apps":"\u1ee8ng d\u1ee5ng b\u1ea3ng th\xf4ng tin theo d\xf5i","Resource Apps":"\u1ee8ng d\u1ee5ng t\xe0i nguy\xean","App Hub":"","By":"B\u01a1\u0309i","Install":"C\xe0i \u0111\u1eb7t"}')},734:function(e){e.exports=JSON.parse('{"App installed successfully":"App\u6210\u529f\u5b89\u88c5","Failed to install app":"App\u5b89\u88c5\u5931\u8d25","App removed successfully":"App\u6210\u529f\u79fb\u9664","Installing app from the app hub...":"\u4ece\u5e94\u7528\u5e02\u573aHub\u5b89\u88c5\u5e94\u7528","Failed to install an app from the app hub":"\u4ece\u5e94\u7528\u5e02\u573a\u5b89\u88c5\u5e94\u7528\u5931\u8d25","Uploading...":"\u4e0a\u4f20","Installing...":"\u5b89\u88c5","No apps found":"\u6ca1\u6709app","No installed apps matched the search term":"\u6ca1\u6709\u7b26\u5408\u641c\u7d22\u6761\u4ef6\u7684app","Standard Apps":"\u6807\u51c6APP","Dashboard Apps":"\u4eea\u8868\u76d8App","Tracker Dashboard Apps":"\u968f\u8bbf\u4eea\u8868\u76d8App","Resource Apps":"\u8d44\u6e90App","App Hub":"APP\u5e02\u573a","By":"\u7531","Install":"\u5b89\u88c5"}')},735:function(e){e.exports=JSON.parse('{"App installed successfully":"App\u6210\u529f\u5b89\u88c5","Failed to install app":"App\u5b89\u88c5\u5931\u8d25","App removed successfully":"App\u6210\u529f\u79fb\u9664","Installing app from the app hub...":"\u4ece\u5e94\u7528\u5e02\u573aHub\u5b89\u88c5\u5e94\u7528","Failed to install an app from the app hub":"\u4ece\u5e94\u7528\u5e02\u573a\u5b89\u88c5\u5e94\u7528\u5931\u8d25","Uploading...":"\u4e0a\u4f20","Installing...":"\u5b89\u88c5","No apps found":"\u6ca1\u6709app","No installed apps matched the search term":"\u6ca1\u6709\u7b26\u5408\u641c\u7d22\u6761\u4ef6\u7684app","Standard Apps":"\u6807\u51c6APP","Dashboard Apps":"\u4eea\u8868\u76d8App","Tracker Dashboard Apps":"\u968f\u8bbf\u4eea\u8868\u76d8App","Resource Apps":"\u8d44\u6e90App","App Hub":"APP\u5e02\u573a","By":"\u7531","Install":"\u5b89\u88c5"}')},737:function(e,a,t){},740:function(e,a,t){"use strict";t.r(a);var s=t(1),p=t.n(s),n=t(372),r=t.n(n),l=t(738),o=t(315);const i=o.a.create();i.getAppFromKey=e=>{const a=i.getState();for(let t=0;t<a.length;t++)if(a[t].key===e)return a[t];return null};var d=i,c=t(3),h=t.n(c),u=t(455),m=t(547),g=t.n(m),b=t(548),A=t.n(b),f=t(277),y=t(560),S=t.n(y),k=t(206),v=t.n(k),T=t(278),I=t.n(T),x=t(261),E=t.n(x),C=t(566),w=t.n(C),N=t(573),H=t(575),R=t.n(H),D=t(576),F=t.n(D),j=t(310),O=t.n(j),U=t(307),B=t.n(U),P=t(225),L=t(193);const W={spacing:O.a,fontFamily:"Roboto, sans-serif",palette:{primary1Color:"#276696",primary2Color:P.blue700,primary3Color:P.blue100,accent1Color:P.orange500,accent2Color:P.grey100,accent3Color:P.grey500,textColor:P.darkBlack,alternateTextColor:P.white,canvasColor:P.white,borderColor:P.grey400,disabledColor:Object(L.fade)(P.darkBlack,.3)}};const _=B()(W),M=function(e){return{sideBar:{backgroundColor:"#F3F3F3",backgroundColorItem:"transparent",backgroundColorItemActive:e.palette.accent2Color,textColor:e.palette.textColor,textColorActive:e.palette.primary1Color,borderStyle:"1px solid #e1e1e1"},forms:{minWidth:350,maxWidth:900}}}(W);var z=Object.assign({},_,M),J=t(578),G=t.n(J),V=t(581),K=t(344),Y=t(343),q=t.n(Y);const X=o.a.create();X.getAppFromVersionId=function(e){for(let a=0;a<X.getState().apps.length;a++){const t=X.getState().apps[a];for(let a=0;a<t.versions.length;a++)if(t.versions[a].id===e)return t.version=t.versions[a],t}return null};var Q=X,Z=t(5),$=t.n(Z);const ee=G()("app-management-app:frontend:client"),ae={installApp:V.a.create("Install App"),uninstallApp:V.a.create("Uninstall App"),refreshApps:V.a.create("Refresh Apps"),appInstalled:V.a.create("An app was installed"),loadAppHub:V.a.create("Load DHIS2 App Hub"),installAppVersion:V.a.create("Install App Version from DHIS2 App Hub"),showSnackbarMessage:V.a.create("Show Snackbar message")};ae.installApp.subscribe(e=>{const[a,t]=Array.isArray(e.data)?e.data:[e.data,void 0];Object(K.getInstance)().then(s=>{s.system.uploadApp(a,t).then(()=>s.system.reloadApps()).then(t=>{d.setState(t),ae.showSnackbarMessage($.a.t("App installed successfully")),ae.appInstalled(a.name.substring(0,a.name.lastIndexOf("."))),ae.refreshApps(),e.complete()}).catch(e=>{let a=$.a.t("Failed to install app");e.message&&(a+=": ".concat(e.message)),ae.showSnackbarMessage(a),q.a.error("Failed to install app:",e.message||e),ae.refreshApps()})})}),ae.uninstallApp.subscribe(e=>{const a=e.data[0];Object(K.getInstance)().then(e=>{e.system.uninstallApp(a).then(()=>{ae.showSnackbarMessage($.a.t("App removed successfully")),ae.refreshApps()})})}),ae.refreshApps.subscribe(()=>{Object(K.getInstance)().then(e=>{e.system.reloadApps().then(e=>{d.setState(e)})})}),ae.loadAppHub.subscribe(async()=>{const e=(await Object(K.getInstance)()).Api.getApi().baseUrl;ee("Got baseUrl: ".concat(e));const a={credentials:"include",headers:{"Content-Type":"application/json"}},t=await(async()=>{const t=await fetch("".concat(e,"/system/info"),a);return(await t.json()).version.replace("-SNAPSHOT","")})();ee("Got dhis2 version: ".concat(t));const s=await fetch("".concat(e,"/appHub/v1/apps?dhis_version=").concat(t),a),p=await s.json();Q.setState(Object.assign(Q.getState()||{},{apps:p}))}),ae.installAppVersion.subscribe(e=>{const a=e.data[0],t=Q.getState();Q.setState(Object.assign(t,{installing:t.installing?t.installing+1:1})),Object(K.getInstance)().then(t=>{ae.showSnackbarMessage($.a.t("Installing app from the app hub...")),function(e,a){const t=a.Api.getApi();return new Promise((a,s)=>{t.post(["appHub",e].join("/"),"",{dataType:"text"}).then(()=>{a()}).catch(e=>{s(e)})})}(a,t).then(()=>t.system.reloadApps()).then(a=>{ae.showSnackbarMessage($.a.t("App installed successfully"));const t=Q.getState();Q.setState(Object.assign(t,{installing:t.installing-1})),d.setState(a),e.complete(a)}).catch(e=>{ae.showSnackbarMessage("".concat($.a.t("Failed to install an app from the app hub"),": ").concat(e.message)),Q.setState(Object.assign(Q.getState(),{installing:Q.getState().installing-1})),q.a.error(e)})})});var te=ae;const se={app:"Installed Standard Apps",dashboard_widget:"Installed Dashboard Apps",tracker_dashboard_widget:"Installed Tracker Dashboard Apps",resource:"Installed Resource Apps"},pe={app:"There are no standard apps installed.",dashboard_widget:"There are no dashboard apps installed.",tracker_dashboard_widget:"There are no tracker dashboard apps installed.",resource:"There are no resource apps installed"},ne={wrapper:{maxWidth:750,position:"relative"},header:{fontSize:24,fontWeight:300,color:z.rawTheme.palette.textColor,padding:"24px 0 12px 16px"},container:{borderBottom:"1px solid #dddddd",paddingBottom:0,marginBottom:8},fab:{position:"absolute",top:45,right:32},fabAnim:{float:"right"},noApps:{marginTop:16,padding:"16px 0 5px 16px",fontWeight:300,fontSize:15},app:{borderTop:"1px solid #dddddd"},appName:{padding:16,clear:"both"},appLink:{textDecoration:"none"},appActions:{display:"inline-block",float:"right",marginTop:-8,marginRight:-16},appButtons:{marginLeft:"1rem"},appIcon:{borderRadius:3},card:{marginTop:8,marginRight:"1rem"}};class re extends p.a.Component{constructor(e,a){super(e,a),this.state={uploading:!1},this.uploadAction=this.uploadAction.bind(this),this.upload=this.upload.bind(this)}componentDidMount(){te.installApp.subscribe(()=>{this.form&&this.form.reset()})}uploadAction(e){this.fileInput.click(e)}upload(e){te.installApp(e.target.files[0],this.props.uploadProgress)}renderInstalledApps(){const e=this.props.appTypeFilter.toLocaleLowerCase(),a=this.props.installedApps.filter(e=>!this.props.appTypeFilter||e.appType===this.props.appTypeFilter);return a.length>0?p.a.createElement("div",null,p.a.createElement("div",{style:ne.header},$.a.t(se[e])),p.a.createElement(f.Card,{style:ne.card},p.a.createElement(f.CardText,null,p.a.createElement(N.List,{style:ne.container},a.map(e=>{const a=te.uninstallApp.bind(null,e.key),t=p.a.createElement(E.a,null,p.a.createElement(v.a,{className:"material-icons",color:"#808080"},"more_vert")),s=window.open.bind(null,e.launchUrl),n=p.a.createElement(w.a,{iconButtonElement:t},p.a.createElement(R.a,{onClick:a},"Uninstall")),r=e.icons&&e.icons[48]?p.a.createElement(I.a,{style:ne.appIcon,src:[e.baseUrl,e.icons[48]].join("/")}):p.a.createElement(I.a,{backgroundColor:z.rawTheme.palette.primary1Color,icon:p.a.createElement(v.a,{className:"material-icons"},"folder")}),l=p.a.createElement("div",null,e.bundled&&p.a.createElement("strong",null,$.a.t("CORE APP")," "),"v",e.version);return p.a.createElement(N.ListItem,{key:e.folderName,primaryText:e.name,secondaryText:l,style:ne.app,onClick:s,leftAvatar:r,rightIconButton:n})})))),this.renderUploadButton()):this.renderEmptyList()}renderEmptyList(){const e=this.props.appTypeFilter.toLocaleLowerCase();return p.a.createElement("div",null,p.a.createElement("div",{style:ne.header},$.a.t(se[e])),p.a.createElement("div",{style:ne.noApps},$.a.t(pe[e])),this.renderUploadButton())}renderUploadButton(){if(!this.props.showUpload)return null;return p.a.createElement("div",null,p.a.createElement("div",{style:ne.fab},p.a.createElement("div",{style:ne.fabAnim,className:"fab"},p.a.createElement(F.a,{onClick:this.uploadAction},p.a.createElement(v.a,{className:"material-icons"},"file_upload")))),p.a.createElement("form",{ref:e=>{this.form=e},style:{visibility:"hidden"}},p.a.createElement("input",{type:"file",ref:e=>{this.fileInput=e},onChange:this.upload})))}render(){return p.a.createElement("div",{style:ne.wrapper},this.renderInstalledApps())}}re.defaultProps={appTypeFilter:"app"};var le=re,oe=t(339),ie=t.n(oe),de=t(739);class ce extends p.a.Component{constructor(e){super(e),this.state={installing:void 0}}UNSAFE_componentWillMount(){Array.isArray(this.props.appHub.apps)||te.loadAppHub()}renderApps(){const e={card:{width:297,float:"left",marginRight:"1rem",marginBottom:"1rem"},cardTitle:{background:"#5892BE",fontWeight:400},cardTitleSubtitle:{color:"#CCDDEE",fontWeight:300,fontSize:13,overflowX:"hidden",overflowY:"hidden",maxWidth:205,whiteSpace:"nowrap",textOverflow:"ellipsis"},cardText:{borderTop:"1px solid #c3c3c3",borderBottom:"1px solid #c3c3c3",height:165,overflowY:"hidden"},actions:{textAlign:"right"},button:{marginRight:0,marginLeft:8},flex:{display:"flex",flexWrap:"wrap"}},a=p.a.createElement(I.a,{backgroundColor:z.rawTheme.palette.primary1Color,icon:p.a.createElement(v.a,{className:"material-icons"},"folder")});return p.a.createElement("div",{style:e.flex},this.props.appHub.apps.map(t=>p.a.createElement(f.Card,{style:e.card,key:t.name},p.a.createElement(f.CardHeader,{title:t.name,subtitle:"".concat($.a.t("By")," ").concat(t.developer.organisation),avatar:a,style:e.cardTitle,titleColor:"white",subtitleStyle:e.cardTitleSubtitle}),p.a.createElement(f.CardText,{style:e.cardText},t.description),p.a.createElement(f.CardActions,{style:e.actions},t.versions.map(a=>{const t=te.installAppVersion.bind(null,a.id);return p.a.createElement(ie.a,{key:a.id,style:e.button,primary:!0,onClick:t,label:"".concat($.a.t("Install")," v").concat(a.version)})})))))}render(){const e={loadingMaskContainer:{position:"fixed",left:256,top:"3rem",right:0,bottom:0,zIndex:1e3},header:{fontSize:24,fontWeight:300,color:z.rawTheme.palette.textColor,padding:"24px 0 12px 16px"},card:{marginTop:8,marginRight:"1rem"},cardTitle:{background:"#5892BE"},cardTitleText:{color:"white",fontSize:28,fontWeight:300},apps:{paddingTop:"1rem"},description:{padding:"1rem",color:"gray",borderRadius:3,clear:"both",fontWeight:300}};return Array.isArray(this.props.appHub.apps)?p.a.createElement("div",null,p.a.createElement("div",{style:e.header},$.a.t("App Hub")),p.a.createElement("div",{style:e.apps},this.renderApps())):p.a.createElement("div",{style:e.loadingMaskContainer},p.a.createElement(de.a,null))}}ce.defaultProps={appHub:{}};var he=ce,ue=t(6);const me=e=>e.split(".").map(Number),ge=(e,a)=>{if(!a)return null;let t;return a.forEach(a=>{var s;((e,a)=>{const t=me(e),s=me(a);return t.some((e,a)=>e<s[a])})((null===(s=t)||void 0===s?void 0:s.version)||e,a.version)&&(t=a)}),t},be=({appHub:e})=>{if(!e.apps)return null;const a=e.apps.find(e=>"DHIS2"===e.developer.organisation&&"App Management"===e.name),t=ge("31.0.0",null===a||void 0===a?void 0:a.versions);if(!a||!t)return null;return p.a.createElement(ue.l,{title:$.a.t("A new version of App Management is available on the App Hub")},p.a.createElement(ue.a,{onClick:async()=>{await te.installAppVersion([t.id]).toPromise(),setTimeout(()=>location.reload(),500)}},$.a.t("Update and reload app")))},Ae={header:{fontSize:24,fontWeight:300,color:z.rawTheme.palette.textColor,padding:"24px 0 12px 16px"},noApps:{marginTop:16,padding:"16px 0 5px 16px",fontWeight:300,fontSize:15},progress:{margin:"16px 1rem 16px 0",padding:16,maxWidth:734},installing:{marginRight:"1rem",paddingRight:"1rem",marginTop:16,padding:16,textAlign:"center",fontSize:14,fontWeight:300,maxWidth:734},snackbar:{right:"initial"},menuLabel:{position:"relative",top:-6,marginLeft:16}};class fe extends p.a.Component{constructor(e,a){super(e,a),this.state={installedApps:[],installing:!1,uploading:!1,progress:void 0,appHub:{},lastUpdate:null},["setSection","progress","closeSnackbar","showSnackbar","search"].forEach(e=>{this[e]=this[e].bind(this)})}getChildContext(){return{d2:this.props.d2,muiTheme:z}}componentDidMount(){this.subscriptions=[d.subscribe(e=>{this.setState({installedApps:e,lastUpdate:new Date})}),Q.subscribe(e=>{this.setState({appHub:e,installing:void 0!==e.installing&&e.installing>0})}),te.installApp.subscribe(()=>{this.setState({uploading:!0})}),te.appInstalled.subscribe(({data:e})=>{this.setState({uploading:!1}),this.setSection(d.getAppFromKey(e).appType.toLowerCase()||"app")}),te.refreshApps.subscribe(()=>{this.setState({uploading:!1})}),te.showSnackbarMessage.subscribe(e=>{this.state.snackbar?(this.setState({snackbar:void 0}),setTimeout(()=>{this.setState({snackbar:e.data})},150)):this.setState({snackbar:e.data})}),te.installAppVersion.subscribe(({data:e})=>{const a=Q.getAppFromVersionId(e[0]);this.setSection(a.appType&&a.appType.toLowerCase()||"app")})],te.loadAppHub()}componentWillUnmount(){this.subscriptions.forEach(e=>{e.dispose()})}setSection(e){this.sidebar&&this.sidebar.clearSearchBox(),this.setState({section:e,appSearch:void 0})}progress(e){e?1===e?this.setState({uploading:!1,progress:void 0}):this.setState({progress:100*e}):this.setState({progress:void 0})}closeSnackbar(){this.setState({snackbar:void 0})}showSnackbar(e){this.setState({snackbar:e})}search(e){e.length>0?this.setState({appSearch:this.state.installedApps.filter(a=>-1!==a.name.toLowerCase().indexOf(e.toLowerCase())).sort((e,a)=>e.appType.localeCompare(a.appType)||e.name.localeCompare(a.name)),appSearchText:e}):this.setState({appSearch:void 0,appSearchText:void 0})}renderUploadProgress(){return this.state.uploading?p.a.createElement(f.Card,{style:Ae.progress},p.a.createElement(f.CardText,null,$.a.t("Uploading..."),p.a.createElement(A.a,{mode:this.state.progress?"determinate":"indeterminate",color:"#6688AA",value:this.state.progress}))):null}renderInstallProgress(){return this.state.installing?p.a.createElement("div",{style:Ae.installing},p.a.createElement(g.a,{mode:"indeterminate",color:"#6688AA",value:this.state.progress}),p.a.createElement("br",null),p.a.createElement("br",null),$.a.t("Installing...")):null}renderSection(e,a,t){if("store"===e)return p.a.createElement(he,{appHub:this.state.appHub,d2:this.props.d2});const s=e&&e.toString().toUpperCase()||"APP";return p.a.createElement(le,{d2:this.props.d2,installedApps:a,uploadProgress:this.progress,transitionUnmount:this.state.unmountSection,showUpload:t&&!this.state.uploading,appHub:this.state.appHub,appTypeFilter:s})}renderSearchResults(){const e=this.state.appSearch.reduce((e,a)=>(Object.prototype.hasOwnProperty.call(e,a.appType)?e[a.appType].push(a):e[a.appType]=[a],e),{});return Object.keys(e).length?Object.keys(e).map((a,t)=>p.a.createElement("div",{key:a},this.renderSection(a,e[a],0===t))):p.a.createElement("div",null,p.a.createElement("div",{style:Ae.header},$.a.t("No apps found")),p.a.createElement("div",{style:Ae.noApps},$.a.t("No installed apps matched the search term"),' "',this.state.appSearchText,'"'))}render(){const e=[{key:"app",icon:"desktop_windows",label:$.a.t("Standard Apps")},{key:"dashboard_widget",icon:"wallpaper",label:$.a.t("Dashboard Apps")},{key:"tracker_dashboard_widget",icon:"supervisor_account",label:$.a.t("Tracker Dashboard Apps")},{key:"resource",icon:"data_usage",label:$.a.t("Resource Apps")},{key:"store",icon:"store",label:$.a.t("App Hub")}].map(e=>({key:e.key,label:e.label,icon:p.a.createElement(v.a,{className:"material-icons"},e.icon)}));return p.a.createElement("div",{className:"app"},p.a.createElement(be,{appHub:this.state.appHub}),p.a.createElement(u.a,{sections:e,currentSection:this.state.section,onChangeSection:this.setSection,showSearchField:!0,onChangeSearchText:this.search,ref:e=>{this.sidebar=e}}),p.a.createElement(S.a,{message:this.state.snackbar||"",autoHideDuration:2500,onRequestClose:this.closeSnackbar,open:!!this.state.snackbar,style:Ae.snackbar}),p.a.createElement("div",{className:"content-area"},this.state.appSearch?this.renderSearchResults():this.renderSection(this.state.section,this.state.installedApps,!0),this.renderUploadProgress(),this.renderInstallProgress()))}}fe.childContextTypes={d2:h.a.object,muiTheme:h.a.object};var ye=fe,Se=t(726),ke=t(727),ve=t(728),Te=t(729),Ie=t(730),xe=t(731),Ee=t(732),Ce=t(733),we=t(734),Ne=t(735);$.a.addResources("ar","default",Se),$.a.addResources("en","default",ke),$.a.addResources("fr","default",ve),$.a.addResources("id","default",Te),$.a.addResources("nb","default",Ie),$.a.addResources("ru","default",xe),$.a.addResources("sv","default",Ee),$.a.addResources("vi","default",Ce),$.a.addResources("zh","default",we),$.a.addResources("zh_CN","default",Ne);$.a,t(736),t(737);a.default=()=>{const{d2:e}=Object(l.a)({onInitialized:e=>{d.setState(e.system.installedApps)}});return e?p.a.createElement(r.a,{muiTheme:z},p.a.createElement(ye,{d2:e})):null}}}]);
//# sourceMappingURL=app.b649743d.chunk.js.map