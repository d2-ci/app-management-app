{"version":3,"sources":["D2App/stores/installedApp.store.js","D2App/theme.js","D2App/stores/appHub.store.js","D2App/actions.js","D2App/components/AppList.component.js","D2App/components/AppHub.component.js","D2App/utils/versions.js","D2App/components/SelfUpdateNoticeBox.component.js","D2App/components/App.component.js","D2App/locales/index.js","D2App/AppWrapper.js"],"names":["store","Store","create","getAppFromKey","appKey","apps","getState","i","length","key","theme","spacing","Spacing","fontFamily","palette","primary1Color","primary2Color","blue700","primary3Color","blue100","accent1Color","orange500","accent2Color","grey100","accent3Color","grey500","textColor","darkBlack","alternateTextColor","white","canvasColor","borderColor","grey400","disabledColor","fade","muiTheme","getMuiTheme","appTheme","style","sideBar","backgroundColor","backgroundColorItem","backgroundColorItemActive","textColorActive","borderStyle","forms","minWidth","maxWidth","createAppTheme","Object","assign","getAppFromVersionId","versionId","app","j","versions","id","version","debug","Debug","actions","installApp","Action","i18n","t","uninstallApp","refreshApps","appInstalled","loadAppHub","installAppVersion","showSnackbarMessage","subscribe","params","zipFile","progressCallback","Array","isArray","data","undefined","getD2","then","d2","system","uploadApp","reloadApps","installedAppHub","setState","name","substring","lastIndexOf","complete","catch","err","message","log","error","async","baseUrl","Api","getApi","fetchOptions","credentials","headers","response","fetch","json","replace","getDhisVersion","appHubStore","appHubState","installing","uid","api","Promise","resolve","reject","post","join","dataType","appHubState2","appTypeHeaders","dashboard_widget","tracker_dashboard_widget","resource","appTypeMissing","styles","wrapper","position","header","fontSize","fontWeight","color","AppTheme","rawTheme","padding","container","borderBottom","paddingBottom","marginBottom","fab","top","right","fabAnim","float","noApps","marginTop","borderTop","appName","clear","appLink","textDecoration","appActions","display","marginRight","appButtons","marginLeft","appIcon","borderRadius","card","AppList","React","Component","constructor","props","context","super","this","state","uploading","uploadAction","bind","upload","componentDidMount","form","reset","e","fileInput","click","target","files","uploadProgress","renderInstalledApps","label","appTypeFilter","toLocaleLowerCase","appList","installedApps","filter","appType","Card","List","map","uninstall","moreIcon","className","open","window","launchUrl","rightIconButton","iconButtonElement","onClick","avatar","icons","src","icon","secondaryText","bundled","folderName","primaryText","leftAvatar","renderUploadButton","renderEmptyList","showUpload","ref","visibility","type","r","onChange","render","defaultProps","AppHub","UNSAFE_componentWillMount","appHub","renderApps","width","cardTitle","background","cardTitleSubtitle","overflowX","overflowY","whiteSpace","textOverflow","cardText","height","textAlign","maxHeight","button","flex","flexWrap","title","subtitle","developer","organisation","titleColor","subtitleStyle","description","install","primary","loadingMaskContainer","left","bottom","zIndex","cardTitleText","paddingTop","getTargetVersion","current","candidates","targetVersion","forEach","candidate","valid","lt","isUpgradeCandidate","SelfUpdateNoticeBox","appManagementApp","find","toPromise","setTimeout","location","reload","progress","margin","paddingRight","snackbar","menuLabel","App","lastUpdate","fn","getChildContext","subscriptions","Date","setSection","toLowerCase","componentWillUnmount","subscription","dispose","sidebar","clearSearchBox","section","appSearch","p","closeSnackbar","showSnackbar","search","text","indexOf","sort","a","b","localeCompare","appSearchText","renderUploadProgress","mode","value","renderInstallProgress","renderSection","toString","toUpperCase","transitionUnmount","unmountSection","renderSearchResults","appsByType","reduce","types","prototype","hasOwnProperty","call","push","keys","sections","currentSection","onChangeSection","showSearchField","onChangeSearchText","autoHideDuration","onRequestClose","childContextTypes","PropTypes","object","addResources","arTranslations","csTranslations","enTranslations","esTranslations","frTranslations","idTranslations","nbTranslations","ruTranslations","svTranslations","uzTranslations","uz_LatnTranslations","viTranslations","zhTranslations","zh_CNTranslations","AppWrapper","useD2","i18nRoot","onInitialized"],"mappings":"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","file":"static/js/app.b60e6919.chunk.js","sourcesContent":["import Store from 'd2-ui/lib/store/Store';\nconst store = Store.create();\n\nstore.getAppFromKey = appKey => {\n  const apps = store.getState();\n\n  for (let i = 0; i < apps.length; i++) {\n    if (apps[i].key === appKey) {\n      return apps[i];\n    }\n  }\n\n  return null;\n};\n\nexport default store;","import Spacing from 'material-ui/styles/spacing';\nimport getMuiTheme from 'material-ui/styles/getMuiTheme';\nimport { blue700, blue100, orange500, grey100, grey500, darkBlack, white, grey400 } from 'material-ui/styles/colors';\nimport { fade } from 'material-ui/utils/colorManipulator';\nconst theme = {\n  spacing: Spacing,\n  fontFamily: 'Roboto, sans-serif',\n  palette: {\n    primary1Color: '#276696',\n    primary2Color: blue700,\n    primary3Color: blue100,\n    accent1Color: orange500,\n    accent2Color: grey100,\n    accent3Color: grey500,\n    textColor: darkBlack,\n    alternateTextColor: white,\n    canvasColor: white,\n    borderColor: grey400,\n    disabledColor: fade(darkBlack, 0.3)\n  }\n};\n\nfunction createAppTheme(style) {\n  return {\n    sideBar: {\n      backgroundColor: '#F3F3F3',\n      backgroundColorItem: 'transparent',\n      backgroundColorItemActive: style.palette.accent2Color,\n      textColor: style.palette.textColor,\n      textColorActive: style.palette.primary1Color,\n      borderStyle: '1px solid #e1e1e1'\n    },\n    forms: {\n      minWidth: 350,\n      maxWidth: 900\n    }\n  };\n}\n\nconst muiTheme = getMuiTheme(theme);\nconst appTheme = createAppTheme(theme);\nexport default Object.assign({}, muiTheme, appTheme);","import Store from 'd2-ui/lib/store/Store';\nconst store = Store.create();\n\nfunction getAppFromVersionId(versionId) {\n  for (let i = 0; i < store.getState().apps.length; i++) {\n    const app = store.getState().apps[i];\n\n    for (let j = 0; j < app.versions.length; j++) {\n      if (app.versions[j].id === versionId) {\n        app.version = app.versions[j];\n        return app;\n      }\n    }\n  }\n\n  return null;\n}\n\nstore.getAppFromVersionId = getAppFromVersionId;\nexport default store;","import Debug from 'debug';\nimport Action from 'd2-ui/lib/action/Action';\nimport { getInstance as getD2 } from 'd2';\nimport log from 'loglevel';\nimport appHubStore from './stores/appHub.store';\nimport installedAppHub from './stores/installedApp.store';\nimport i18n from '@dhis2/d2-i18n';\nconst debug = Debug('app-management-app:frontend:client');\nconst actions = {\n  // App management actions\n  installApp: Action.create(i18n.t('Install App')),\n  uninstallApp: Action.create(i18n.t('Uninstall App')),\n  refreshApps: Action.create(i18n.t('Refresh Apps')),\n  appInstalled: Action.create(i18n.t('An app was installed')),\n  // App store actions\n  loadAppHub: Action.create(i18n.t('Load DHIS2 App Hub')),\n  installAppVersion: Action.create(i18n.t('Install App Version from DHIS2 App Hub')),\n  // Snackbar\n  showSnackbarMessage: Action.create(i18n.t('Show Snackbar message'))\n};\n/*\n * Install app from zip file\n */\n\nactions.installApp.subscribe(params => {\n  const [zipFile, progressCallback] = Array.isArray(params.data) ? params.data : [params.data, undefined];\n  getD2().then(d2 => {\n    d2.system.uploadApp(zipFile, progressCallback).then(() => d2.system.reloadApps()).then(apps => {\n      installedAppHub.setState(apps);\n      actions.showSnackbarMessage(i18n.t('App installed successfully'));\n      actions.appInstalled(zipFile.name.substring(0, zipFile.name.lastIndexOf('.')));\n      actions.refreshApps();\n      params.complete();\n    }).catch(err => {\n      let message = i18n.t('Failed to install app');\n\n      if (err.message) {\n        message += `: ${err.message}`;\n      }\n\n      actions.showSnackbarMessage(message);\n      log.error('Failed to install app:', err.message || err);\n      actions.refreshApps();\n    });\n  });\n});\n/*\n * Uninstall app\n */\n\nactions.uninstallApp.subscribe(params => {\n  const appKey = params.data[0];\n  getD2().then(d2 => {\n    d2.system.uninstallApp(appKey).then(() => {\n      actions.showSnackbarMessage(i18n.t('App removed successfully'));\n      actions.refreshApps();\n    });\n  });\n});\n/*\n * Refresh the list of installed apps\n */\n\nactions.refreshApps.subscribe(() => {\n  getD2().then(d2 => {\n    d2.system.reloadApps().then(apps => {\n      installedAppHub.setState(apps);\n    });\n  });\n});\n/*\n * Load the app hub\n */\n\nactions.loadAppHub.subscribe(async () => {\n  const d2 = await getD2();\n  const baseUrl = d2.Api.getApi().baseUrl;\n  debug(`Got baseUrl: ${baseUrl}`);\n  const fetchOptions = {\n    credentials: 'include',\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  };\n\n  const getDhisVersion = async () => {\n    const response = await fetch(`${baseUrl}/system/info`, fetchOptions);\n    const json = await response.json(); //if we're running a dev version remove the snapshot suffix to just keep the dhis version\n\n    return json.version.replace('-SNAPSHOT', '');\n  };\n\n  const version = await getDhisVersion();\n  debug(`Got dhis2 version: ${version}`);\n  const response = await fetch(`${baseUrl}/appHub/v1/apps?dhis_version=${version}`, fetchOptions);\n  const apps = await response.json();\n  appHubStore.setState(Object.assign(appHubStore.getState() || {}, {\n    apps\n  }));\n});\n/*\n * Install app version from the app hub\n */\n\nactions.installAppVersion.subscribe(params => {\n  const versionId = params.data[0];\n  const appHubState = appHubStore.getState();\n  appHubStore.setState(Object.assign(appHubState, {\n    installing: appHubState.installing ? appHubState.installing + 1 : 1\n  }));\n  getD2().then(d2 => {\n    actions.showSnackbarMessage(i18n.t('Installing app from the app hub...'));\n    installAppVersion(versionId, d2).then(() => d2.system.reloadApps()).then(apps => {\n      actions.showSnackbarMessage(i18n.t('App installed successfully'));\n      const appHubState2 = appHubStore.getState();\n      appHubStore.setState(Object.assign(appHubState2, {\n        installing: appHubState2.installing - 1\n      }));\n      installedAppHub.setState(apps);\n      params.complete(apps);\n    }).catch(err => {\n      actions.showSnackbarMessage(`${i18n.t('Failed to install an app from the app hub')}: ${err.message}`);\n      appHubStore.setState(Object.assign(appHubStore.getState(), {\n        installing: appHubStore.getState().installing - 1\n      }));\n      log.error(err);\n    });\n  });\n});\n\nfunction installAppVersion(uid, d2) {\n  const api = d2.Api.getApi();\n  return new Promise((resolve, reject) => {\n    api.post(['appHub', uid].join('/'), '', {\n      dataType: 'text'\n    }).then(() => {\n      resolve();\n    }).catch(err => {\n      reject(err);\n    });\n  });\n}\n\nexport default actions;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Avatar from 'material-ui/Avatar';\nimport IconButton from 'material-ui/IconButton';\nimport IconMenu from 'material-ui/IconMenu';\nimport { List, ListItem } from 'material-ui/List';\nimport MenuItem from 'material-ui/MenuItem';\nimport { Card, CardText } from 'material-ui/Card';\nimport FloatingActionButton from 'material-ui/FloatingActionButton';\nimport FontIcon from 'material-ui/FontIcon';\nimport AppTheme from '../theme';\nimport actions from '../actions';\nimport i18n from '@dhis2/d2-i18n'; // const appTypeLabels = {\n//     app: i18n.t('Standard Apps'),\n//     dashboard_widget: i18n.t('Dashboard Apps'),\n//     tracker_dashboard_widget: i18n.t('Tracker Dashboard Apps'),\n//     resource: i18n.t('Resource Apps'),\n// }\n\nconst appTypeHeaders = {\n  app: i18n.t('Installed Standard Apps'),\n  dashboard_widget: i18n.t('Installed Dashboard Apps'),\n  tracker_dashboard_widget: i18n.t('Installed Tracker Dashboard Apps'),\n  resource: i18n.t('Installed Resource Apps')\n};\nconst appTypeMissing = {\n  app: i18n.t('There are no standard apps installed.'),\n  dashboard_widget: i18n.t('There are no dashboard apps installed.'),\n  tracker_dashboard_widget: i18n.t('There are no tracker dashboard apps installed.'),\n  resource: i18n.t('There are no resource apps installed')\n};\nconst styles = {\n  wrapper: {\n    maxWidth: 750,\n    position: 'relative'\n  },\n  header: {\n    fontSize: 24,\n    fontWeight: 300,\n    color: AppTheme.rawTheme.palette.textColor,\n    padding: '24px 0 12px 16px'\n  },\n  container: {\n    borderBottom: '1px solid #dddddd',\n    paddingBottom: 0,\n    marginBottom: 8\n  },\n  fab: {\n    position: 'absolute',\n    top: 45,\n    right: 32\n  },\n  fabAnim: {\n    float: 'right'\n  },\n  noApps: {\n    marginTop: 16,\n    padding: '16px 0 5px 16px',\n    fontWeight: 300,\n    fontSize: 15\n  },\n  app: {\n    borderTop: '1px solid #dddddd'\n  },\n  appName: {\n    padding: 16,\n    clear: 'both'\n  },\n  appLink: {\n    textDecoration: 'none'\n  },\n  appActions: {\n    display: 'inline-block',\n    float: 'right',\n    marginTop: -8,\n    marginRight: -16\n  },\n  appButtons: {\n    marginLeft: '1rem'\n  },\n  appIcon: {\n    borderRadius: 3\n  },\n  card: {\n    marginTop: 8,\n    marginRight: '1rem'\n  }\n};\n\nclass AppList extends React.Component {\n  constructor(props, context) {\n    super(props, context);\n    this.state = {\n      uploading: false\n    };\n    this.uploadAction = this.uploadAction.bind(this);\n    this.upload = this.upload.bind(this);\n  }\n\n  componentDidMount() {\n    actions.installApp.subscribe(() => {\n      if (this.form) {\n        this.form.reset();\n      }\n    });\n  }\n\n  uploadAction(e) {\n    this.fileInput.click(e);\n  }\n\n  upload(e) {\n    actions.installApp(e.target.files[0], this.props.uploadProgress);\n  }\n\n  renderInstalledApps() {\n    const label = this.props.appTypeFilter.toLocaleLowerCase();\n    const appList = this.props.installedApps.filter(app => !this.props.appTypeFilter || app.appType === this.props.appTypeFilter);\n\n    if (appList.length > 0) {\n      return <div>\n                    <div style={styles.header}>{appTypeHeaders[label]}</div>\n                    <Card style={styles.card}>\n                        <CardText>\n                            <List style={styles.container}>\n                                {appList.map(app => {\n                const uninstall = actions.uninstallApp.bind(null, app.key);\n                const moreIcon = <IconButton>\n                                            <FontIcon className=\"material-icons\" color=\"#808080\">\n                                                more_vert\n                                            </FontIcon>\n                                        </IconButton>;\n                const open = window.open.bind(null, app.launchUrl);\n                const rightIconButton = <IconMenu iconButtonElement={moreIcon}>\n                                            <MenuItem onClick={uninstall}>\n                                                Uninstall\n                                            </MenuItem>\n                                        </IconMenu>;\n                const avatar = app.icons && app.icons['48'] ? <Avatar style={styles.appIcon} src={[app.baseUrl, app.icons['48']].join('/')} /> : <Avatar backgroundColor={AppTheme.rawTheme.palette.primary1Color} icon={<FontIcon className=\"material-icons\">\n                                                        folder\n                                                    </FontIcon>} />;\n                const secondaryText = <div>\n                                            {app.bundled && <strong>\n                                                    {i18n.t('CORE APP')}{' '}\n                                                </strong>}\n                                            v{app.version}\n                                        </div>;\n                return <ListItem key={app.folderName} primaryText={app.name} secondaryText={secondaryText} style={styles.app} onClick={open} leftAvatar={avatar} rightIconButton={rightIconButton} />;\n              })}\n                            </List>\n                        </CardText>\n                    </Card>\n                    {this.renderUploadButton()}\n                </div>;\n    }\n\n    return this.renderEmptyList();\n  }\n\n  renderEmptyList() {\n    const label = this.props.appTypeFilter.toLocaleLowerCase();\n    return <div>\n                <div style={styles.header}>{appTypeHeaders[label]}</div>\n                <div style={styles.noApps}>{appTypeMissing[label]}</div>\n                {this.renderUploadButton()}\n            </div>;\n  }\n\n  renderUploadButton() {\n    if (!this.props.showUpload) {\n      return null;\n    }\n\n    const setFormRef = ref => {\n      this.form = ref;\n    };\n\n    const theref = r => {\n      this.fileInput = r;\n    };\n\n    return <div>\n                <div style={styles.fab}>\n                    <div style={styles.fabAnim} className=\"fab\">\n                        <FloatingActionButton onClick={this.uploadAction}>\n                            <FontIcon className=\"material-icons\">\n                                file_upload\n                            </FontIcon>\n                        </FloatingActionButton>\n                    </div>\n                </div>\n                <form ref={setFormRef} style={{\n        visibility: 'hidden'\n      }}>\n                    <input type=\"file\" ref={theref} onChange={this.upload} />\n                </form>\n            </div>;\n  }\n\n  render() {\n    return <div style={styles.wrapper}>{this.renderInstalledApps()}</div>;\n  }\n\n}\n\nAppList.propTypes = {\n  appTypeFilter: PropTypes.oneOf(['APP', 'DASHBOARD_WIDGET', 'TRACKER_DASHBOARD_WIDGET', 'RESOURCE']).isRequired,\n  installedApps: PropTypes.array.isRequired,\n  showUpload: PropTypes.bool.isRequired,\n  uploadProgress: PropTypes.func.isRequired\n};\nAppList.defaultProps = {\n  appTypeFilter: 'app'\n};\nexport default AppList;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Card, CardActions, CardHeader, CardText } from 'material-ui/Card';\nimport FlatButton from 'material-ui/FlatButton';\nimport FontIcon from 'material-ui/FontIcon';\nimport Avatar from 'material-ui/Avatar';\nimport LoadingMask from 'd2-ui/lib/loading-mask/LoadingMask.component';\nimport AppTheme from '../theme';\nimport actions from '../actions';\nimport i18n from '@dhis2/d2-i18n';\n/*\n * Discontinued...\nfunction parseDescription(description) {\n    return {\n        __html: description\n        // Linkify email addresses\n            .replace(\n                /([\\w.]*\\w@[\\w.]*\\w\\.[a-zA-Z]{2,})/g,\n                '<a href=\"mailto:$1\" rel=\"nofollow\" target=\"_blank\">$1</a>'\n            )\n            // Linkify http:// and https:// links\n            .replace(/(https?:\\/\\/[\\w./]*)/g, '<a href=\"$1\" rel=\"nofollow\" target=\"_blank\">$1</a>')\n            // Convert newlines to HTML line breaks\n            .replace(/\\n/g, '\\n<br/>'),\n    };\n}\n*/\n\nclass AppHub extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      installing: undefined\n    };\n  }\n\n  UNSAFE_componentWillMount() {\n    if (!Array.isArray(this.props.appHub.apps)) {\n      actions.loadAppHub();\n    }\n  }\n\n  renderApps() {\n    const styles = {\n      card: {\n        width: 297,\n        float: 'left',\n        marginRight: '1rem',\n        marginBottom: '1rem'\n      },\n      cardTitle: {\n        background: '#5892BE',\n        fontWeight: 400\n      },\n      cardTitleSubtitle: {\n        color: '#CCDDEE',\n        fontWeight: 300,\n        fontSize: 13,\n        overflowX: 'hidden',\n        overflowY: 'hidden',\n        maxWidth: 205,\n        whiteSpace: 'nowrap',\n        textOverflow: 'ellipsis'\n      },\n      cardText: {\n        borderTop: '1px solid #c3c3c3',\n        borderBottom: '1px solid #c3c3c3',\n        height: 165,\n        overflowY: 'hidden'\n      },\n      actions: {\n        textAlign: 'right',\n        maxHeight: '150px',\n        overflowY: 'auto'\n      },\n      button: {\n        marginBottom: '0.25em'\n      },\n      flex: {\n        display: 'flex',\n        flexWrap: 'wrap'\n      }\n    };\n    const avatar = <Avatar backgroundColor={AppTheme.rawTheme.palette.primary1Color} icon={<FontIcon className=\"material-icons\">folder</FontIcon>} />;\n    return <div style={styles.flex}>\n                {this.props.appHub.apps.map(app => <Card style={styles.card} key={app.name}>\n                        <CardHeader title={app.name} subtitle={`${i18n.t('By')} ${app.developer.organisation}`} avatar={avatar} style={styles.cardTitle} titleColor=\"white\" subtitleStyle={styles.cardTitleSubtitle} />\n                        <CardText style={styles.cardText}>\n                            {app.description}\n                        </CardText>\n                        <CardActions style={styles.actions}>\n                            {app.versions.map(version => {\n            const install = actions.installAppVersion.bind(null, version.id);\n            return <div key={version.id}>\n                                        <FlatButton style={styles.button} primary onClick={install} label={`${i18n.t('Install')} v${version.version}`} />\n                                    </div>;\n          })}\n                        </CardActions>\n                    </Card>)}\n            </div>;\n  }\n\n  render() {\n    const styles = {\n      loadingMaskContainer: {\n        position: 'fixed',\n        left: 256,\n        top: '3rem',\n        right: 0,\n        bottom: 0,\n        zIndex: 1000\n      },\n      header: {\n        fontSize: 24,\n        fontWeight: 300,\n        color: AppTheme.rawTheme.palette.textColor,\n        padding: '24px 0 12px 16px'\n      },\n      card: {\n        marginTop: 8,\n        marginRight: '1rem'\n      },\n      cardTitle: {\n        background: '#5892BE'\n      },\n      cardTitleText: {\n        color: 'white',\n        fontSize: 28,\n        fontWeight: 300\n      },\n      apps: {\n        paddingTop: '1rem'\n      },\n      description: {\n        padding: '1rem',\n        color: 'gray',\n        borderRadius: 3,\n        clear: 'both',\n        fontWeight: 300\n      }\n    };\n    return Array.isArray(this.props.appHub.apps) ? <div>\n                <div style={styles.header}>{i18n.t('App Hub')}</div>\n                <div style={styles.apps}>{this.renderApps()}</div>\n            </div> : <div style={styles.loadingMaskContainer}>\n                <LoadingMask />\n            </div>;\n  }\n\n}\n\nAppHub.propTypes = {\n  appHub: PropTypes.object.isRequired\n};\nAppHub.defaultProps = {\n  appHub: {}\n};\nexport default AppHub;","import { valid, lt } from 'semver';\nexport const isUpgradeCandidate = (current, candidate) => valid(current) === null || valid(candidate) !== null && lt(current, candidate);\nexport const getTargetVersion = (current, candidates) => {\n  if (!candidates || !candidates.length) return null;\n  let targetVersion;\n  candidates.forEach(candidate => {\n    if (isUpgradeCandidate(targetVersion?.version || current, candidate.version)) {\n      targetVersion = candidate;\n    }\n  });\n  return targetVersion;\n};","/* global __VERSION__,__APP_HUB_ID__ */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { NoticeBox, Button } from '@dhis2/ui';\nimport i18n from '@dhis2/d2-i18n';\nimport actions from '../actions';\nimport { getTargetVersion } from '../utils/versions';\nconst currentVersion = \"31.2.0\";\nconst appManagementAppId = \"28823170-1203-46d1-81d5-eea67abae41c\";\nexport const SelfUpdateNoticeBox = ({\n  appHub\n}) => {\n  if (!appHub.apps) return null; // TODO: Fetch app management app from App Hub directly (by id)\n\n  const appManagementApp = appHub.apps.find(app => app.id === appManagementAppId);\n  const targetVersion = getTargetVersion(currentVersion, appManagementApp?.versions);\n\n  if (!appManagementApp || !targetVersion) {\n    return null;\n  }\n\n  const upgradeSelf = async () => {\n    await actions.installAppVersion([targetVersion.id]).toPromise();\n    setTimeout(() => location.reload(), 500);\n  };\n\n  return <NoticeBox title={i18n.t('A new version of App Management is available on the App Hub')}>\n            <Button onClick={upgradeSelf}>\n                {i18n.t('Update and reload app')}\n            </Button>\n        </NoticeBox>;\n};\nSelfUpdateNoticeBox.propTypes = {\n  appHub: PropTypes.object.isRequired\n};","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Sidebar from 'd2-ui/lib/sidebar/Sidebar.component';\nimport CircularProgress from 'material-ui/CircularProgress';\nimport LinearProgress from 'material-ui/LinearProgress';\nimport { Card, CardText } from 'material-ui/Card';\nimport Snackbar from 'material-ui/Snackbar';\nimport FontIcon from 'material-ui/FontIcon';\nimport AppList from './AppList.component';\nimport AppHub from './AppHub.component';\nimport { SelfUpdateNoticeBox } from './SelfUpdateNoticeBox.component';\nimport AppTheme from '../theme';\nimport actions from '../actions';\nimport appHubStore from '../stores/appHub.store';\nimport installedAppHub from '../stores/installedApp.store';\nimport i18n from '@dhis2/d2-i18n';\nconst styles = {\n  header: {\n    fontSize: 24,\n    fontWeight: 300,\n    color: AppTheme.rawTheme.palette.textColor,\n    padding: '24px 0 12px 16px'\n  },\n  noApps: {\n    marginTop: 16,\n    padding: '16px 0 5px 16px',\n    fontWeight: 300,\n    fontSize: 15\n  },\n  progress: {\n    margin: '16px 1rem 16px 0',\n    padding: 16,\n    maxWidth: 734\n  },\n  installing: {\n    marginRight: '1rem',\n    paddingRight: '1rem',\n    marginTop: 16,\n    padding: 16,\n    textAlign: 'center',\n    fontSize: 14,\n    fontWeight: 300,\n    maxWidth: 734\n  },\n  snackbar: {\n    // left: '2rem',\n    right: 'initial'\n  },\n  menuLabel: {\n    position: 'relative',\n    top: -6,\n    marginLeft: 16\n  }\n};\n\nclass App extends React.Component {\n  constructor(props, context) {\n    super(props, context);\n    this.state = {\n      installedApps: [],\n      installing: false,\n      uploading: false,\n      progress: undefined,\n      appHub: {},\n      lastUpdate: null\n    } // Bind 'this' for functions that need it\n    ;\n    ['setSection', 'progress', 'closeSnackbar', 'showSnackbar', 'search'].forEach(fn => {\n      this[fn] = this[fn].bind(this);\n    });\n  }\n\n  getChildContext() {\n    return {\n      d2: this.props.d2,\n      muiTheme: AppTheme\n    };\n  }\n\n  componentDidMount() {\n    this.subscriptions = [installedAppHub.subscribe(installedApps => {\n      this.setState({\n        installedApps,\n        lastUpdate: new Date()\n      });\n    }), appHubStore.subscribe(appHub => {\n      this.setState({\n        appHub,\n        installing: appHub.installing !== undefined && appHub.installing > 0\n      });\n    }), actions.installApp.subscribe(() => {\n      this.setState({\n        uploading: true\n      });\n    }), actions.appInstalled.subscribe(({\n      data\n    }) => {\n      this.setState({\n        uploading: false\n      });\n      this.setSection(installedAppHub.getAppFromKey(data).appType.toLowerCase() || 'app');\n    }), actions.refreshApps.subscribe(() => {\n      this.setState({\n        uploading: false\n      });\n    }), actions.showSnackbarMessage.subscribe(params => {\n      if (this.state.snackbar) {\n        this.setState({\n          snackbar: undefined\n        });\n        setTimeout(() => {\n          this.setState({\n            snackbar: params.data\n          });\n        }, 150);\n      } else {\n        this.setState({\n          snackbar: params.data\n        });\n      }\n    }), actions.installAppVersion.subscribe(({\n      data\n    }) => {\n      const app = appHubStore.getAppFromVersionId(data[0]);\n      this.setSection(app.appType && app.appType.toLowerCase() || 'app');\n    })];\n    actions.loadAppHub();\n  }\n\n  componentWillUnmount() {\n    this.subscriptions.forEach(subscription => {\n      subscription.dispose();\n    });\n  }\n\n  setSection(key) {\n    if (this.sidebar) {\n      this.sidebar.clearSearchBox();\n    }\n\n    this.setState({\n      section: key,\n      appSearch: undefined\n    });\n  }\n\n  progress(p) {\n    if (p) {\n      if (p === 1) {\n        this.setState({\n          uploading: false,\n          progress: undefined\n        });\n      } else {\n        this.setState({\n          progress: p * 100\n        });\n      }\n    } else {\n      this.setState({\n        progress: undefined\n      });\n    }\n  }\n\n  closeSnackbar() {\n    this.setState({\n      snackbar: undefined\n    });\n  }\n\n  showSnackbar(message) {\n    this.setState({\n      snackbar: message\n    });\n  }\n\n  search(text) {\n    if (text.length > 0) {\n      this.setState({\n        appSearch: this.state.installedApps.filter(app => app.name.toLowerCase().indexOf(text.toLowerCase()) !== -1).sort((a, b) => a.appType.localeCompare(b.appType) || a.name.localeCompare(b.name)),\n        appSearchText: text\n      });\n    } else {\n      this.setState({\n        appSearch: undefined,\n        appSearchText: undefined\n      });\n    }\n  }\n\n  renderUploadProgress() {\n    if (this.state.uploading) {\n      return <Card style={styles.progress}>\n                    <CardText>\n                        {i18n.t('Uploading...')}\n                        <LinearProgress mode={this.state.progress ? 'determinate' : 'indeterminate'} color=\"#6688AA\" value={this.state.progress} />\n                    </CardText>\n                </Card>;\n    }\n\n    return null;\n  }\n\n  renderInstallProgress() {\n    if (this.state.installing) {\n      return <div style={styles.installing}>\n                    <CircularProgress mode=\"indeterminate\" color=\"#6688AA\" // size={0.75}\n        value={this.state.progress} />\n                    <br />\n                    <br />\n                    {i18n.t('Installing...')}\n                </div>;\n    }\n\n    return null;\n  }\n\n  renderSection(key, apps, showUpload) {\n    if (key === 'store') {\n      return <AppHub appHub={this.state.appHub} d2={this.props.d2} />;\n    }\n\n    const filter = key && key.toString().toUpperCase() || 'APP';\n    return <AppList d2={this.props.d2} installedApps={apps} uploadProgress={this.progress} transitionUnmount={this.state.unmountSection} showUpload={showUpload && !this.state.uploading} appHub={this.state.appHub} appTypeFilter={filter} />;\n  }\n\n  renderSearchResults() {\n    const appsByType = this.state.appSearch.reduce((types, app) => {\n      if (Object.prototype.hasOwnProperty.call(types, app.appType)) {\n        types[app.appType].push(app);\n      } else {\n        types[app.appType] = [app]; // eslint-disable-line\n      }\n\n      return types;\n    }, {});\n\n    if (Object.keys(appsByType).length) {\n      return Object.keys(appsByType).map((type, i) => <div key={type}>\n                    {this.renderSection(type, appsByType[type], i === 0)}\n                </div>);\n    }\n\n    return <div>\n                <div style={styles.header}>{i18n.t('No apps found')}</div>\n                <div style={styles.noApps}>\n                    {i18n.t('No installed apps matched the search term')} &quot;\n                    {this.state.appSearchText}&quot;\n                </div>\n            </div>;\n  }\n\n  render() {\n    const sections = [{\n      key: 'app',\n      icon: 'desktop_windows',\n      label: i18n.t('Standard Apps')\n    }, {\n      key: 'dashboard_widget',\n      icon: 'wallpaper',\n      label: i18n.t('Dashboard Apps')\n    }, {\n      key: 'tracker_dashboard_widget',\n      icon: 'supervisor_account',\n      label: i18n.t('Tracker Dashboard Apps')\n    }, {\n      key: 'resource',\n      icon: 'data_usage',\n      label: i18n.t('Resource Apps')\n    }, {\n      key: 'store',\n      icon: 'store',\n      label: i18n.t('App Hub')\n    }].map(section => ({\n      key: section.key,\n      label: section.label,\n      icon: <FontIcon className=\"material-icons\">{section.icon}</FontIcon>\n    }));\n\n    const reffer = r => {\n      this.sidebar = r;\n    };\n\n    return <div className=\"app\">\n                <SelfUpdateNoticeBox appHub={this.state.appHub} />\n                <Sidebar sections={sections} currentSection={this.state.section} onChangeSection={this.setSection} showSearchField onChangeSearchText={this.search} ref={reffer} />\n                <Snackbar message={this.state.snackbar || ''} autoHideDuration={2500} onRequestClose={this.closeSnackbar} open={!!this.state.snackbar} style={styles.snackbar} />\n                <div className=\"content-area\">\n                    {this.state.appSearch ? this.renderSearchResults() : this.renderSection(this.state.section, this.state.installedApps, true)}\n                    {this.renderUploadProgress()}\n                    {this.renderInstallProgress()}\n                </div>\n            </div>;\n  }\n\n}\n\nApp.propTypes = {\n  d2: PropTypes.object.isRequired\n};\nApp.childContextTypes = {\n  d2: PropTypes.object,\n  muiTheme: PropTypes.object\n};\nexport default App;","//------------------------------------------------------------------------------\n// <auto-generated>\n// This code was generated by d2-i18n-generate.\n//\n// Changes to this file may cause incorrect behavior and will be lost if\n// the code is regenerated.\n// </auto-generated>\n//------------------------------------------------------------------------------\nimport i18n from '@dhis2/d2-i18n';\nimport arTranslations from './ar/translations.json';\nimport csTranslations from './cs/translations.json';\nimport enTranslations from './en/translations.json';\nimport esTranslations from './es/translations.json';\nimport frTranslations from './fr/translations.json';\nimport idTranslations from './id/translations.json';\nimport nbTranslations from './nb/translations.json';\nimport ruTranslations from './ru/translations.json';\nimport svTranslations from './sv/translations.json';\nimport uzTranslations from './uz/translations.json';\nimport uz_LatnTranslations from './uz_Latn/translations.json';\nimport viTranslations from './vi/translations.json';\nimport zhTranslations from './zh/translations.json';\nimport zh_CNTranslations from './zh_CN/translations.json';\nconst namespace = 'default';\ni18n.addResources('ar', namespace, arTranslations);\ni18n.addResources('cs', namespace, csTranslations);\ni18n.addResources('en', namespace, enTranslations);\ni18n.addResources('es', namespace, esTranslations);\ni18n.addResources('fr', namespace, frTranslations);\ni18n.addResources('id', namespace, idTranslations);\ni18n.addResources('nb', namespace, nbTranslations);\ni18n.addResources('ru', namespace, ruTranslations);\ni18n.addResources('sv', namespace, svTranslations);\ni18n.addResources('uz', namespace, uzTranslations);\ni18n.addResources('uz_Latn', namespace, uz_LatnTranslations);\ni18n.addResources('vi', namespace, viTranslations);\ni18n.addResources('zh', namespace, zhTranslations);\ni18n.addResources('zh_CN', namespace, zh_CNTranslations);\nexport default i18n;","import React from 'react';\nimport MuiThemeProvider from 'material-ui/styles/MuiThemeProvider';\nimport { useD2 } from '@dhis2/app-runtime-adapter-d2';\nimport installedAppHub from './stores/installedApp.store';\nimport App from './components/App.component';\nimport theme from './theme';\nimport './locales';\nimport 'material-design-icons-iconfont/dist/material-design-icons.css';\nimport './scss/style.scss';\n\nconst AppWrapper = () => {\n  const {\n    d2\n  } = useD2({\n    i18nRoot: './i18n_legacy',\n    onInitialized: d2 => {\n      installedAppHub.setState(d2.system.installedApps);\n    }\n  });\n\n  if (!d2) {\n    return null;\n  }\n\n  return <MuiThemeProvider muiTheme={theme}>\n            <App d2={d2} />\n        </MuiThemeProvider>;\n};\n\nexport default AppWrapper;"],"sourceRoot":""}