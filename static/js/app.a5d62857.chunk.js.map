{"version":3,"sources":["D2App/stores/installedApp.store.js","D2App/theme.js","D2App/stores/appHub.store.js","D2App/actions.js","D2App/components/AppList.component.js","D2App/components/AppHub.component.js","D2App/components/SelfUpdateNoticeBox.component.js","D2App/components/App.component.js","D2App/locales/index.js","D2App/AppWrapper.js"],"names":["store","Store","create","getAppFromKey","appKey","apps","getState","i","length","key","theme","spacing","Spacing","fontFamily","palette","primary1Color","primary2Color","blue700","primary3Color","blue100","accent1Color","orange500","accent2Color","grey100","accent3Color","grey500","textColor","darkBlack","alternateTextColor","white","canvasColor","borderColor","grey400","disabledColor","fade","muiTheme","getMuiTheme","appTheme","style","sideBar","backgroundColor","backgroundColorItem","backgroundColorItemActive","textColorActive","borderStyle","forms","minWidth","maxWidth","createAppTheme","Object","assign","getAppFromVersionId","versionId","app","j","versions","id","version","debug","Debug","actions","installApp","Action","uninstallApp","refreshApps","appInstalled","loadAppHub","installAppVersion","showSnackbarMessage","subscribe","params","zipFile","progressCallback","Array","isArray","data","undefined","getD2","then","d2","system","uploadApp","reloadApps","installedAppHub","setState","i18n","t","name","substring","lastIndexOf","complete","catch","err","message","log","error","async","baseUrl","Api","getApi","fetchOptions","credentials","headers","url","response","fetch","json","apiUrl","getAppHubUrl","replace","getDhisVersion","corsOptions","mode","appHubStore","appHubState","installing","uid","api","Promise","resolve","reject","post","join","dataType","appHubState2","appTypeHeaders","dashboard_widget","tracker_dashboard_widget","resource","appTypeMissing","styles","wrapper","position","header","fontSize","fontWeight","color","AppTheme","rawTheme","padding","container","borderBottom","paddingBottom","marginBottom","fab","top","right","fabAnim","float","noApps","marginTop","borderTop","appName","clear","appLink","textDecoration","appActions","display","marginRight","appButtons","marginLeft","appIcon","borderRadius","card","AppList","React","Component","constructor","props","context","super","this","state","uploading","uploadAction","bind","upload","componentDidMount","form","reset","e","fileInput","click","target","files","uploadProgress","renderInstalledApps","label","appTypeFilter","toLocaleLowerCase","appList","installedApps","filter","appType","Card","List","map","uninstall","moreIcon","className","open","window","launchUrl","rightIconButton","iconButtonElement","onClick","avatar","icons","src","icon","secondaryText","isBundledApp","folderName","primaryText","leftAvatar","renderUploadButton","renderEmptyList","showUpload","ref","visibility","type","r","onChange","render","defaultProps","AppHub","UNSAFE_componentWillMount","appHub","renderApps","width","cardTitle","background","cardTitleSubtitle","overflowX","overflowY","whiteSpace","textOverflow","cardText","height","textAlign","button","flex","flexWrap","title","subtitle","developer","organisation","titleColor","subtitleStyle","description","install","primary","loadingMaskContainer","left","bottom","zIndex","cardTitleText","paddingTop","parseVersion","versionString","split","Number","getTargetVersion","current","targetVersion","forEach","candidate","currentVersion","candidateVersion","needsUpdate","SelfUpdateNoticeBox","appManagementApp","find","toPromise","setTimeout","location","reload","progress","margin","paddingRight","snackbar","menuLabel","App","lastUpdate","fn","getChildContext","subscriptions","Date","setSection","toLowerCase","componentWillUnmount","subscription","dispose","sidebar","clearSearchBox","section","appSearch","p","closeSnackbar","showSnackbar","search","text","indexOf","sort","a","b","localeCompare","appSearchText","renderUploadProgress","value","renderInstallProgress","renderSection","toString","toUpperCase","transitionUnmount","unmountSection","renderSearchResults","appsByType","reduce","types","prototype","hasOwnProperty","call","push","keys","sections","currentSection","onChangeSection","showSearchField","onChangeSearchText","autoHideDuration","onRequestClose","childContextTypes","PropTypes","object","addResources","arTranslations","enTranslations","frTranslations","idTranslations","nbTranslations","ruTranslations","svTranslations","viTranslations","zhTranslations","zh_CNTranslations","AppWrapper","useD2","onInitialized"],"mappings":"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","file":"static/js/app.a5d62857.chunk.js","sourcesContent":["import Store from 'd2-ui/lib/store/Store';\nconst store = Store.create();\n\nstore.getAppFromKey = appKey => {\n  const apps = store.getState();\n\n  for (let i = 0; i < apps.length; i++) {\n    if (apps[i].key === appKey) {\n      return apps[i];\n    }\n  }\n\n  return null;\n};\n\nexport default store;","import Spacing from 'material-ui/styles/spacing';\nimport getMuiTheme from 'material-ui/styles/getMuiTheme';\nimport { blue700, blue100, orange500, grey100, grey500, darkBlack, white, grey400 } from 'material-ui/styles/colors';\nimport { fade } from 'material-ui/utils/colorManipulator';\nconst theme = {\n  spacing: Spacing,\n  fontFamily: 'Roboto, sans-serif',\n  palette: {\n    primary1Color: '#276696',\n    primary2Color: blue700,\n    primary3Color: blue100,\n    accent1Color: orange500,\n    accent2Color: grey100,\n    accent3Color: grey500,\n    textColor: darkBlack,\n    alternateTextColor: white,\n    canvasColor: white,\n    borderColor: grey400,\n    disabledColor: fade(darkBlack, 0.3)\n  }\n};\n\nfunction createAppTheme(style) {\n  return {\n    sideBar: {\n      backgroundColor: '#F3F3F3',\n      backgroundColorItem: 'transparent',\n      backgroundColorItemActive: style.palette.accent2Color,\n      textColor: style.palette.textColor,\n      textColorActive: style.palette.primary1Color,\n      borderStyle: '1px solid #e1e1e1'\n    },\n    forms: {\n      minWidth: 350,\n      maxWidth: 900\n    }\n  };\n}\n\nconst muiTheme = getMuiTheme(theme);\nconst appTheme = createAppTheme(theme);\nexport default Object.assign({}, muiTheme, appTheme);","import Store from 'd2-ui/lib/store/Store';\nconst store = Store.create();\n\nfunction getAppFromVersionId(versionId) {\n  for (let i = 0; i < store.getState().apps.length; i++) {\n    const app = store.getState().apps[i];\n\n    for (let j = 0; j < app.versions.length; j++) {\n      if (app.versions[j].id === versionId) {\n        app.version = app.versions[j];\n        return app;\n      }\n    }\n  }\n\n  return null;\n}\n\nstore.getAppFromVersionId = getAppFromVersionId;\nexport default store;","import Debug from 'debug';\nimport Action from 'd2-ui/lib/action/Action';\nimport { getInstance as getD2 } from 'd2';\nimport log from 'loglevel';\nimport appHubStore from './stores/appHub.store';\nimport installedAppHub from './stores/installedApp.store';\nimport i18n from '@dhis2/d2-i18n';\nconst debug = Debug('app-management-app:frontend:client');\nconst actions = {\n  // App management actions\n  installApp: Action.create('Install App'),\n  uninstallApp: Action.create('Uninstall App'),\n  refreshApps: Action.create('Refresh Apps'),\n  appInstalled: Action.create('An app was installed'),\n  // App store actions\n  loadAppHub: Action.create('Load DHIS2 App Hub'),\n  installAppVersion: Action.create('Install App Version from DHIS2 App Hub'),\n  // Snackbar\n  showSnackbarMessage: Action.create('Show Snackbar message')\n};\n/*\n * Install app from zip file\n */\n\nactions.installApp.subscribe(params => {\n  const [zipFile, progressCallback] = Array.isArray(params.data) ? params.data : [params.data, undefined];\n  getD2().then(d2 => {\n    d2.system.uploadApp(zipFile, progressCallback).then(() => d2.system.reloadApps()).then(apps => {\n      installedAppHub.setState(apps);\n      actions.showSnackbarMessage(i18n.t('App installed successfully'));\n      actions.appInstalled(zipFile.name.substring(0, zipFile.name.lastIndexOf('.')));\n      actions.refreshApps();\n      params.complete();\n    }).catch(err => {\n      let message = i18n.t('Failed to install app');\n\n      if (err.message) {\n        message += `: ${err.message}`;\n      }\n\n      actions.showSnackbarMessage(message);\n      log.error('Failed to install app:', err.message || err);\n      actions.refreshApps();\n    });\n  });\n});\n/*\n * Uninstall app\n */\n\nactions.uninstallApp.subscribe(params => {\n  const appKey = params.data[0];\n  getD2().then(d2 => {\n    d2.system.uninstallApp(appKey).then(() => {\n      actions.showSnackbarMessage(i18n.t('App removed successfully'));\n      actions.refreshApps();\n    });\n  });\n});\n/*\n * Refresh the list of installed apps\n */\n\nactions.refreshApps.subscribe(() => {\n  getD2().then(d2 => {\n    d2.system.reloadApps().then(apps => {\n      installedAppHub.setState(apps);\n    });\n  });\n});\n/*\n * Load the app hub\n */\n\nactions.loadAppHub.subscribe(async () => {\n  const d2 = await getD2();\n  const baseUrl = d2.Api.getApi().baseUrl;\n  debug(`Got baseUrl: ${baseUrl}`);\n  const fetchOptions = {\n    credentials: 'include',\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  };\n\n  const getAppHubUrl = async () => {\n    const response = await fetch(`${baseUrl}/configuration/appHubUrl`, fetchOptions);\n    const dhis2Configuration = await response.json();\n    return dhis2Configuration.apiUrl;\n  };\n\n  const getDhisVersion = async () => {\n    const response = await fetch(`${baseUrl}/system/info`, fetchOptions);\n    const json = await response.json(); //if we're running a dev version remove the snapshot suffix to just keep the dhis version\n\n    return json.version.replace('-SNAPSHOT', '');\n  };\n\n  const url = await getAppHubUrl();\n  debug(`Got apphub url: ${url}`);\n  const version = await getDhisVersion();\n  debug(`Got dhis2 version: ${version}`);\n  const corsOptions = { ...fetchOptions,\n    mode: 'cors',\n    credentials: undefined\n  };\n  debug('Using fetch/cors options:', corsOptions);\n  const response = await fetch(`${url}/apps?dhis_version=${version}`, corsOptions);\n  const apps = await response.json();\n  appHubStore.setState(Object.assign(appHubStore.getState() || {}, {\n    apps\n  }));\n});\n/*\n * Install app version from the app hub\n */\n\nactions.installAppVersion.subscribe(params => {\n  const versionId = params.data[0];\n  const appHubState = appHubStore.getState();\n  appHubStore.setState(Object.assign(appHubState, {\n    installing: appHubState.installing ? appHubState.installing + 1 : 1\n  }));\n  getD2().then(d2 => {\n    actions.showSnackbarMessage(i18n.t('Installing app from the app hub...'));\n    installAppVersion(versionId, d2).then(() => d2.system.reloadApps()).then(apps => {\n      actions.showSnackbarMessage(i18n.t('App installed successfully'));\n      const appHubState2 = appHubStore.getState();\n      appHubStore.setState(Object.assign(appHubState2, {\n        installing: appHubState2.installing - 1\n      }));\n      installedAppHub.setState(apps);\n      params.complete(apps);\n    }).catch(err => {\n      actions.showSnackbarMessage(`${i18n.t('Failed to install an app from the app hub')}: ${err.message}`);\n      appHubStore.setState(Object.assign(appHubStore.getState(), {\n        installing: appHubStore.getState().installing - 1\n      }));\n      log.error(err);\n    });\n  });\n});\n\nfunction installAppVersion(uid, d2) {\n  const api = d2.Api.getApi();\n  return new Promise((resolve, reject) => {\n    api.post(['appHub', uid].join('/'), '', {\n      dataType: 'text'\n    }).then(() => {\n      resolve();\n    }).catch(err => {\n      reject(err);\n    });\n  });\n}\n\nexport default actions;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Avatar from 'material-ui/Avatar';\nimport IconButton from 'material-ui/IconButton';\nimport IconMenu from 'material-ui/IconMenu';\nimport { List, ListItem } from 'material-ui/List';\nimport MenuItem from 'material-ui/MenuItem';\nimport { Card, CardText } from 'material-ui/Card';\nimport FloatingActionButton from 'material-ui/FloatingActionButton';\nimport FontIcon from 'material-ui/FontIcon';\nimport AppTheme from '../theme';\nimport actions from '../actions';\nimport i18n from '@dhis2/d2-i18n'; // const appTypeLabels = {\n//     app: 'Standard Apps',\n//     dashboard_widget: 'Dashboard Apps',\n//     tracker_dashboard_widget: 'Tracker Dashboard Apps',\n//     resource: 'Resource Apps',\n// }\n\nconst appTypeHeaders = {\n  app: 'Installed Standard Apps',\n  dashboard_widget: 'Installed Dashboard Apps',\n  tracker_dashboard_widget: 'Installed Tracker Dashboard Apps',\n  resource: 'Installed Resource Apps'\n};\nconst appTypeMissing = {\n  app: 'There are no standard apps installed.',\n  dashboard_widget: 'There are no dashboard apps installed.',\n  tracker_dashboard_widget: 'There are no tracker dashboard apps installed.',\n  resource: 'There are no resource apps installed'\n};\nconst styles = {\n  wrapper: {\n    maxWidth: 750,\n    position: 'relative'\n  },\n  header: {\n    fontSize: 24,\n    fontWeight: 300,\n    color: AppTheme.rawTheme.palette.textColor,\n    padding: '24px 0 12px 16px'\n  },\n  container: {\n    borderBottom: '1px solid #dddddd',\n    paddingBottom: 0,\n    marginBottom: 8\n  },\n  fab: {\n    position: 'absolute',\n    top: 45,\n    right: 32\n  },\n  fabAnim: {\n    float: 'right'\n  },\n  noApps: {\n    marginTop: 16,\n    padding: '16px 0 5px 16px',\n    fontWeight: 300,\n    fontSize: 15\n  },\n  app: {\n    borderTop: '1px solid #dddddd'\n  },\n  appName: {\n    padding: 16,\n    clear: 'both'\n  },\n  appLink: {\n    textDecoration: 'none'\n  },\n  appActions: {\n    display: 'inline-block',\n    float: 'right',\n    marginTop: -8,\n    marginRight: -16\n  },\n  appButtons: {\n    marginLeft: '1rem'\n  },\n  appIcon: {\n    borderRadius: 3\n  },\n  card: {\n    marginTop: 8,\n    marginRight: '1rem'\n  }\n};\n\nclass AppList extends React.Component {\n  constructor(props, context) {\n    super(props, context);\n    this.state = {\n      uploading: false\n    };\n    this.uploadAction = this.uploadAction.bind(this);\n    this.upload = this.upload.bind(this);\n  }\n\n  componentDidMount() {\n    actions.installApp.subscribe(() => {\n      if (this.form) {\n        this.form.reset();\n      }\n    });\n  }\n\n  uploadAction(e) {\n    this.fileInput.click(e);\n  }\n\n  upload(e) {\n    actions.installApp(e.target.files[0], this.props.uploadProgress);\n  }\n\n  renderInstalledApps() {\n    const label = this.props.appTypeFilter.toLocaleLowerCase();\n    const appList = this.props.installedApps.filter(app => !this.props.appTypeFilter || app.appType === this.props.appTypeFilter);\n\n    if (appList.length > 0) {\n      return <div>\n                    <div style={styles.header}>\n                        {i18n.t(appTypeHeaders[label])}\n                    </div>\n                    <Card style={styles.card}>\n                        <CardText>\n                            <List style={styles.container}>\n                                {appList.map(app => {\n                const uninstall = actions.uninstallApp.bind(null, app.key);\n                const moreIcon = <IconButton>\n                                            <FontIcon className=\"material-icons\" color=\"#808080\">\n                                                more_vert\n                                            </FontIcon>\n                                        </IconButton>;\n                const open = window.open.bind(null, app.launchUrl);\n                const rightIconButton = <IconMenu iconButtonElement={moreIcon}>\n                                            <MenuItem onClick={uninstall}>\n                                                Uninstall\n                                            </MenuItem>\n                                        </IconMenu>;\n                const avatar = app.icons && app.icons['48'] ? <Avatar style={styles.appIcon} src={[app.baseUrl, app.icons['48']].join('/')} /> : <Avatar backgroundColor={AppTheme.rawTheme.palette.primary1Color} icon={<FontIcon className=\"material-icons\">\n                                                        folder\n                                                    </FontIcon>} />;\n                const secondaryText = <div>\n                                            {app.isBundledApp && <strong>\n                                                    {i18n.t('CORE APP')}{' '}\n                                                </strong>}\n                                            v{app.version}\n                                        </div>;\n                return <ListItem key={app.folderName} primaryText={app.name} secondaryText={secondaryText} style={styles.app} onClick={open} leftAvatar={avatar} rightIconButton={rightIconButton} />;\n              })}\n                            </List>\n                        </CardText>\n                    </Card>\n                    {this.renderUploadButton()}\n                </div>;\n    }\n\n    return this.renderEmptyList();\n  }\n\n  renderEmptyList() {\n    const label = this.props.appTypeFilter.toLocaleLowerCase();\n    return <div>\n                <div style={styles.header}>{i18n.t(appTypeHeaders[label])}</div>\n                <div style={styles.noApps}>{i18n.t(appTypeMissing[label])}</div>\n                {this.renderUploadButton()}\n            </div>;\n  }\n\n  renderUploadButton() {\n    if (!this.props.showUpload) {\n      return null;\n    }\n\n    const setFormRef = ref => {\n      this.form = ref;\n    };\n\n    const theref = r => {\n      this.fileInput = r;\n    };\n\n    return <div>\n                <div style={styles.fab}>\n                    <div style={styles.fabAnim} className=\"fab\">\n                        <FloatingActionButton onClick={this.uploadAction}>\n                            <FontIcon className=\"material-icons\">\n                                file_upload\n                            </FontIcon>\n                        </FloatingActionButton>\n                    </div>\n                </div>\n                <form ref={setFormRef} style={{\n        visibility: 'hidden'\n      }}>\n                    <input type=\"file\" ref={theref} onChange={this.upload} />\n                </form>\n            </div>;\n  }\n\n  render() {\n    return <div style={styles.wrapper}>{this.renderInstalledApps()}</div>;\n  }\n\n}\n\nAppList.propTypes = {\n  appTypeFilter: PropTypes.oneOf(['APP', 'DASHBOARD_WIDGET', 'TRACKER_DASHBOARD_WIDGET', 'RESOURCE']).isRequired,\n  installedApps: PropTypes.array.isRequired,\n  showUpload: PropTypes.bool.isRequired,\n  uploadProgress: PropTypes.func.isRequired\n};\nAppList.defaultProps = {\n  appTypeFilter: 'app'\n};\nexport default AppList;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Card, CardActions, CardHeader, CardText } from 'material-ui/Card';\nimport FlatButton from 'material-ui/FlatButton';\nimport FontIcon from 'material-ui/FontIcon';\nimport Avatar from 'material-ui/Avatar';\nimport LoadingMask from 'd2-ui/lib/loading-mask/LoadingMask.component';\nimport AppTheme from '../theme';\nimport actions from '../actions';\nimport i18n from '@dhis2/d2-i18n';\n/*\n * Discontinued...\nfunction parseDescription(description) {\n    return {\n        __html: description\n        // Linkify email addresses\n            .replace(\n                /([\\w.]*\\w@[\\w.]*\\w\\.[a-zA-Z]{2,})/g,\n                '<a href=\"mailto:$1\" rel=\"nofollow\" target=\"_blank\">$1</a>'\n            )\n            // Linkify http:// and https:// links\n            .replace(/(https?:\\/\\/[\\w./]*)/g, '<a href=\"$1\" rel=\"nofollow\" target=\"_blank\">$1</a>')\n            // Convert newlines to HTML line breaks\n            .replace(/\\n/g, '\\n<br/>'),\n    };\n}\n*/\n\nclass AppHub extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      installing: undefined\n    };\n  }\n\n  UNSAFE_componentWillMount() {\n    if (!Array.isArray(this.props.appHub.apps)) {\n      actions.loadAppHub();\n    }\n  }\n\n  renderApps() {\n    const styles = {\n      card: {\n        width: 297,\n        float: 'left',\n        marginRight: '1rem',\n        marginBottom: '1rem'\n      },\n      cardTitle: {\n        background: '#5892BE',\n        fontWeight: 400\n      },\n      cardTitleSubtitle: {\n        color: '#CCDDEE',\n        fontWeight: 300,\n        fontSize: 13,\n        overflowX: 'hidden',\n        overflowY: 'hidden',\n        maxWidth: 205,\n        whiteSpace: 'nowrap',\n        textOverflow: 'ellipsis'\n      },\n      cardText: {\n        borderTop: '1px solid #c3c3c3',\n        borderBottom: '1px solid #c3c3c3',\n        height: 165,\n        overflowY: 'hidden'\n      },\n      actions: {\n        textAlign: 'right'\n      },\n      button: {\n        marginRight: 0,\n        marginLeft: 8\n      },\n      flex: {\n        display: 'flex',\n        flexWrap: 'wrap'\n      }\n    };\n    const avatar = <Avatar backgroundColor={AppTheme.rawTheme.palette.primary1Color} icon={<FontIcon className=\"material-icons\">folder</FontIcon>} />;\n    return <div style={styles.flex}>\n                {this.props.appHub.apps.map(app => <Card style={styles.card} key={app.name}>\n                        <CardHeader title={app.name} subtitle={`${i18n.t('By')} ${app.developer.organisation}`} avatar={avatar} style={styles.cardTitle} titleColor=\"white\" subtitleStyle={styles.cardTitleSubtitle} />\n                        <CardText style={styles.cardText}>\n                            {app.description}\n                        </CardText>\n                        <CardActions style={styles.actions}>\n                            {app.versions.map(version => {\n            const install = actions.installAppVersion.bind(null, version.id);\n            return <FlatButton key={version.id} style={styles.button} primary onClick={install} label={`${i18n.t('Install')} v${version.version}`} />;\n          })}\n                        </CardActions>\n                    </Card>)}\n            </div>;\n  }\n\n  render() {\n    const styles = {\n      loadingMaskContainer: {\n        position: 'fixed',\n        left: 256,\n        top: '3rem',\n        right: 0,\n        bottom: 0,\n        zIndex: 1000\n      },\n      header: {\n        fontSize: 24,\n        fontWeight: 300,\n        color: AppTheme.rawTheme.palette.textColor,\n        padding: '24px 0 12px 16px'\n      },\n      card: {\n        marginTop: 8,\n        marginRight: '1rem'\n      },\n      cardTitle: {\n        background: '#5892BE'\n      },\n      cardTitleText: {\n        color: 'white',\n        fontSize: 28,\n        fontWeight: 300\n      },\n      apps: {\n        paddingTop: '1rem'\n      },\n      description: {\n        padding: '1rem',\n        color: 'gray',\n        borderRadius: 3,\n        clear: 'both',\n        fontWeight: 300\n      }\n    };\n    return Array.isArray(this.props.appHub.apps) ? <div>\n                <div style={styles.header}>{i18n.t('App Hub')}</div>\n                <div style={styles.apps}>{this.renderApps()}</div>\n            </div> : <div style={styles.loadingMaskContainer}>\n                <LoadingMask />\n            </div>;\n  }\n\n}\n\nAppHub.propTypes = {\n  appHub: PropTypes.object.isRequired\n};\nAppHub.defaultProps = {\n  appHub: {}\n};\nexport default AppHub;","/* global __VERSION__ */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { NoticeBox, Button } from '@dhis2/ui';\nimport i18n from '@dhis2/d2-i18n';\nimport actions from '../actions';\nconst currentVersion = \"31.2.0\";\nconst appManagementAppOrg = 'DHIS2';\nconst appManagementAppName = 'App Management';\n\nconst parseVersion = versionString => versionString.split('.').map(Number);\n\nconst needsUpdate = (current, candidate) => {\n  const currentVersion = parseVersion(current);\n  const candidateVersion = parseVersion(candidate);\n\n  for (let i = 0; i < currentVersion.length; ++i) {\n    if (candidateVersion[i] > currentVersion[i]) {\n      return true;\n    }\n\n    if (candidateVersion[i] === currentVersion[i]) {\n      continue;\n    }\n\n    if (candidateVersion[i] < currentVersion[i]) {\n      return false;\n    }\n  }\n\n  return false;\n};\n\nconst getTargetVersion = (current, versions) => {\n  if (!versions) return null;\n  let targetVersion;\n  versions.forEach(candidate => {\n    if (needsUpdate(targetVersion?.version || current, candidate.version)) {\n      targetVersion = candidate;\n    }\n  });\n  return targetVersion;\n};\n\nexport const SelfUpdateNoticeBox = ({\n  appHub\n}) => {\n  if (!appHub.apps) return null;\n  const appManagementApp = appHub.apps.find(app => app.developer.organisation === appManagementAppOrg && app.name === appManagementAppName);\n  const targetVersion = getTargetVersion(currentVersion, appManagementApp?.versions);\n\n  if (!appManagementApp || !targetVersion) {\n    return null;\n  }\n\n  const upgradeSelf = async () => {\n    await actions.installAppVersion([targetVersion.id]).toPromise();\n    setTimeout(() => location.reload(), 500);\n  };\n\n  return <NoticeBox title={i18n.t('A new version of App Management is available on the App Hub')}>\n            <Button onClick={upgradeSelf}>\n                {i18n.t('Update and reload app')}\n            </Button>\n        </NoticeBox>;\n};\nSelfUpdateNoticeBox.propTypes = {\n  appHub: PropTypes.object.isRequired\n};","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Sidebar from 'd2-ui/lib/sidebar/Sidebar.component';\nimport CircularProgress from 'material-ui/CircularProgress';\nimport LinearProgress from 'material-ui/LinearProgress';\nimport { Card, CardText } from 'material-ui/Card';\nimport Snackbar from 'material-ui/Snackbar';\nimport FontIcon from 'material-ui/FontIcon';\nimport AppList from './AppList.component';\nimport AppHub from './AppHub.component';\nimport { SelfUpdateNoticeBox } from './SelfUpdateNoticeBox.component';\nimport AppTheme from '../theme';\nimport actions from '../actions';\nimport appHubStore from '../stores/appHub.store';\nimport installedAppHub from '../stores/installedApp.store';\nimport i18n from '@dhis2/d2-i18n';\nconst styles = {\n  header: {\n    fontSize: 24,\n    fontWeight: 300,\n    color: AppTheme.rawTheme.palette.textColor,\n    padding: '24px 0 12px 16px'\n  },\n  noApps: {\n    marginTop: 16,\n    padding: '16px 0 5px 16px',\n    fontWeight: 300,\n    fontSize: 15\n  },\n  progress: {\n    margin: '16px 1rem 16px 0',\n    padding: 16,\n    maxWidth: 734\n  },\n  installing: {\n    marginRight: '1rem',\n    paddingRight: '1rem',\n    marginTop: 16,\n    padding: 16,\n    textAlign: 'center',\n    fontSize: 14,\n    fontWeight: 300,\n    maxWidth: 734\n  },\n  snackbar: {\n    // left: '2rem',\n    right: 'initial'\n  },\n  menuLabel: {\n    position: 'relative',\n    top: -6,\n    marginLeft: 16\n  }\n};\n\nclass App extends React.Component {\n  constructor(props, context) {\n    super(props, context);\n    this.state = {\n      installedApps: [],\n      installing: false,\n      uploading: false,\n      progress: undefined,\n      appHub: {},\n      lastUpdate: null\n    } // Bind 'this' for functions that need it\n    ;\n    ['setSection', 'progress', 'closeSnackbar', 'showSnackbar', 'search'].forEach(fn => {\n      this[fn] = this[fn].bind(this);\n    });\n  }\n\n  getChildContext() {\n    return {\n      d2: this.props.d2,\n      muiTheme: AppTheme\n    };\n  }\n\n  componentDidMount() {\n    this.subscriptions = [installedAppHub.subscribe(installedApps => {\n      this.setState({\n        installedApps,\n        lastUpdate: new Date()\n      });\n    }), appHubStore.subscribe(appHub => {\n      this.setState({\n        appHub,\n        installing: appHub.installing !== undefined && appHub.installing > 0\n      });\n    }), actions.installApp.subscribe(() => {\n      this.setState({\n        uploading: true\n      });\n    }), actions.appInstalled.subscribe(({\n      data\n    }) => {\n      this.setState({\n        uploading: false\n      });\n      this.setSection(installedAppHub.getAppFromKey(data).appType.toLowerCase() || 'app');\n    }), actions.refreshApps.subscribe(() => {\n      this.setState({\n        uploading: false\n      });\n    }), actions.showSnackbarMessage.subscribe(params => {\n      if (this.state.snackbar) {\n        this.setState({\n          snackbar: undefined\n        });\n        setTimeout(() => {\n          this.setState({\n            snackbar: params.data\n          });\n        }, 150);\n      } else {\n        this.setState({\n          snackbar: params.data\n        });\n      }\n    }), actions.installAppVersion.subscribe(({\n      data\n    }) => {\n      const app = appHubStore.getAppFromVersionId(data[0]);\n      this.setSection(app.appType && app.appType.toLowerCase() || 'app');\n    })];\n    actions.loadAppHub();\n  }\n\n  componentWillUnmount() {\n    this.subscriptions.forEach(subscription => {\n      subscription.dispose();\n    });\n  }\n\n  setSection(key) {\n    if (this.sidebar) {\n      this.sidebar.clearSearchBox();\n    }\n\n    this.setState({\n      section: key,\n      appSearch: undefined\n    });\n  }\n\n  progress(p) {\n    if (p) {\n      if (p === 1) {\n        this.setState({\n          uploading: false,\n          progress: undefined\n        });\n      } else {\n        this.setState({\n          progress: p * 100\n        });\n      }\n    } else {\n      this.setState({\n        progress: undefined\n      });\n    }\n  }\n\n  closeSnackbar() {\n    this.setState({\n      snackbar: undefined\n    });\n  }\n\n  showSnackbar(message) {\n    this.setState({\n      snackbar: message\n    });\n  }\n\n  search(text) {\n    if (text.length > 0) {\n      this.setState({\n        appSearch: this.state.installedApps.filter(app => app.name.toLowerCase().indexOf(text.toLowerCase()) !== -1).sort((a, b) => a.appType.localeCompare(b.appType) || a.name.localeCompare(b.name)),\n        appSearchText: text\n      });\n    } else {\n      this.setState({\n        appSearch: undefined,\n        appSearchText: undefined\n      });\n    }\n  }\n\n  renderUploadProgress() {\n    if (this.state.uploading) {\n      return <Card style={styles.progress}>\n                    <CardText>\n                        {i18n.t('Uploading...')}\n                        <LinearProgress mode={this.state.progress ? 'determinate' : 'indeterminate'} color=\"#6688AA\" value={this.state.progress} />\n                    </CardText>\n                </Card>;\n    }\n\n    return null;\n  }\n\n  renderInstallProgress() {\n    if (this.state.installing) {\n      return <div style={styles.installing}>\n                    <CircularProgress mode=\"indeterminate\" color=\"#6688AA\" // size={0.75}\n        value={this.state.progress} />\n                    <br />\n                    <br />\n                    {i18n.t('Installing...')}\n                </div>;\n    }\n\n    return null;\n  }\n\n  renderSection(key, apps, showUpload) {\n    if (key === 'store') {\n      return <AppHub appHub={this.state.appHub} d2={this.props.d2} />;\n    }\n\n    const filter = key && key.toString().toUpperCase() || 'APP';\n    return <AppList d2={this.props.d2} installedApps={apps} uploadProgress={this.progress} transitionUnmount={this.state.unmountSection} showUpload={showUpload && !this.state.uploading} appHub={this.state.appHub} appTypeFilter={filter} />;\n  }\n\n  renderSearchResults() {\n    const appsByType = this.state.appSearch.reduce((types, app) => {\n      if (Object.prototype.hasOwnProperty.call(types, app.appType)) {\n        types[app.appType].push(app);\n      } else {\n        types[app.appType] = [app]; // eslint-disable-line\n      }\n\n      return types;\n    }, {});\n\n    if (Object.keys(appsByType).length) {\n      return Object.keys(appsByType).map((type, i) => <div key={type}>\n                    {this.renderSection(type, appsByType[type], i === 0)}\n                </div>);\n    }\n\n    return <div>\n                <div style={styles.header}>{i18n.t('No apps found')}</div>\n                <div style={styles.noApps}>\n                    {i18n.t('No installed apps matched the search term')} &quot;\n                    {this.state.appSearchText}&quot;\n                </div>\n            </div>;\n  }\n\n  render() {\n    const sections = [{\n      key: 'app',\n      icon: 'desktop_windows',\n      label: i18n.t('Standard Apps')\n    }, {\n      key: 'dashboard_widget',\n      icon: 'wallpaper',\n      label: i18n.t('Dashboard Apps')\n    }, {\n      key: 'tracker_dashboard_widget',\n      icon: 'supervisor_account',\n      label: i18n.t('Tracker Dashboard Apps')\n    }, {\n      key: 'resource',\n      icon: 'data_usage',\n      label: i18n.t('Resource Apps')\n    }, {\n      key: 'store',\n      icon: 'store',\n      label: i18n.t('App Hub')\n    }].map(section => ({\n      key: section.key,\n      label: section.label,\n      icon: <FontIcon className=\"material-icons\">{section.icon}</FontIcon>\n    }));\n\n    const reffer = r => {\n      this.sidebar = r;\n    };\n\n    return <div className=\"app\">\n                <SelfUpdateNoticeBox appHub={this.state.appHub} />\n                <Sidebar sections={sections} currentSection={this.state.section} onChangeSection={this.setSection} showSearchField onChangeSearchText={this.search} ref={reffer} />\n                <Snackbar message={this.state.snackbar || ''} autoHideDuration={2500} onRequestClose={this.closeSnackbar} open={!!this.state.snackbar} style={styles.snackbar} />\n                <div className=\"content-area\">\n                    {this.state.appSearch ? this.renderSearchResults() : this.renderSection(this.state.section, this.state.installedApps, true)}\n                    {this.renderUploadProgress()}\n                    {this.renderInstallProgress()}\n                </div>\n            </div>;\n  }\n\n}\n\nApp.propTypes = {\n  d2: PropTypes.object.isRequired\n};\nApp.childContextTypes = {\n  d2: PropTypes.object,\n  muiTheme: PropTypes.object\n};\nexport default App;","//------------------------------------------------------------------------------\n// <auto-generated>\n// This code was generated by d2-i18n-generate.\n//\n// Changes to this file may cause incorrect behavior and will be lost if\n// the code is regenerated.\n// </auto-generated>\n//------------------------------------------------------------------------------\nimport i18n from '@dhis2/d2-i18n';\nimport arTranslations from './ar/translations.json';\nimport enTranslations from './en/translations.json';\nimport frTranslations from './fr/translations.json';\nimport idTranslations from './id/translations.json';\nimport nbTranslations from './nb/translations.json';\nimport ruTranslations from './ru/translations.json';\nimport svTranslations from './sv/translations.json';\nimport viTranslations from './vi/translations.json';\nimport zhTranslations from './zh/translations.json';\nimport zh_CNTranslations from './zh_CN/translations.json';\nconst namespace = 'default';\ni18n.addResources('ar', namespace, arTranslations);\ni18n.addResources('en', namespace, enTranslations);\ni18n.addResources('fr', namespace, frTranslations);\ni18n.addResources('id', namespace, idTranslations);\ni18n.addResources('nb', namespace, nbTranslations);\ni18n.addResources('ru', namespace, ruTranslations);\ni18n.addResources('sv', namespace, svTranslations);\ni18n.addResources('vi', namespace, viTranslations);\ni18n.addResources('zh', namespace, zhTranslations);\ni18n.addResources('zh_CN', namespace, zh_CNTranslations);\nexport default i18n;","import React from 'react';\nimport MuiThemeProvider from 'material-ui/styles/MuiThemeProvider';\nimport { useD2 } from '@dhis2/app-runtime-adapter-d2';\nimport installedAppHub from './stores/installedApp.store';\nimport App from './components/App.component';\nimport theme from './theme';\nimport './locales';\nimport 'material-design-icons-iconfont/dist/material-design-icons.css';\nimport './scss/style.scss';\n\nconst AppWrapper = () => {\n  const {\n    d2\n  } = useD2({\n    onInitialized: d2 => {\n      installedAppHub.setState(d2.system.installedApps);\n    }\n  });\n\n  if (!d2) {\n    return null;\n  }\n\n  return <MuiThemeProvider muiTheme={theme}>\n            <App d2={d2} />\n        </MuiThemeProvider>;\n};\n\nexport default AppWrapper;"],"sourceRoot":""}